<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.42.4 (0)
 -->
<!-- Title: GPT_Architecture Pages: 1 -->
<svg width="23584pt" height="1603pt"
 viewBox="0.00 0.00 23584.00 1602.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1598.5)">
<title>GPT_Architecture</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1598.5 23580,-1598.5 23580,4 -4,4"/>
<text text-anchor="middle" x="11788" y="-1579.3" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="14.00">GPT Architecture</text>
<text text-anchor="middle" x="11788" y="-1564.3" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="14.00">d_model=1024 | n_layer=24 | n_head=16 | n_kv_head=16</text>
<text text-anchor="middle" x="11788" y="-1549.3" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="14.00">max_seq_len=4096 | vocab=50257</text>
<g id="clust1" class="cluster">
<title>cluster_layer_0</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="504,-1412.5 504,-1533.5 1349,-1533.5 1349,-1412.5 504,-1412.5"/>
<text text-anchor="middle" x="926.5" y="-1519.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_1</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="1425,-1342.5 1425,-1463.5 2284,-1463.5 2284,-1342.5 1425,-1342.5"/>
<text text-anchor="middle" x="1854.5" y="-1449.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_2</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="2360,-1269.5 2360,-1390.5 3219,-1390.5 3219,-1269.5 2360,-1269.5"/>
<text text-anchor="middle" x="2789.5" y="-1376.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_3</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="3295,-1184.5 3295,-1305.5 4154,-1305.5 4154,-1184.5 3295,-1184.5"/>
<text text-anchor="middle" x="3724.5" y="-1291.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_4</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="4230,-1129.5 4230,-1250.5 5089,-1250.5 5089,-1129.5 4230,-1129.5"/>
<text text-anchor="middle" x="4659.5" y="-1236.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 4</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer_5</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="5165,-1047.5 5165,-1168.5 6024,-1168.5 6024,-1047.5 5165,-1047.5"/>
<text text-anchor="middle" x="5594.5" y="-1154.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 5</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer_6</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="6100,-963.5 6100,-1084.5 6959,-1084.5 6959,-963.5 6100,-963.5"/>
<text text-anchor="middle" x="6529.5" y="-1070.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 6</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer_7</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="7035,-879.5 7035,-1000.5 7894,-1000.5 7894,-879.5 7035,-879.5"/>
<text text-anchor="middle" x="7464.5" y="-986.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 7</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer_8</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="7970,-797.5 7970,-918.5 8829,-918.5 8829,-797.5 7970,-797.5"/>
<text text-anchor="middle" x="8399.5" y="-904.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 8</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer_9</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="8905,-721.5 8905,-842.5 9764,-842.5 9764,-721.5 8905,-721.5"/>
<text text-anchor="middle" x="9334.5" y="-828.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 9</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer_10</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="9840,-642.5 9840,-763.5 10699,-763.5 10699,-642.5 9840,-642.5"/>
<text text-anchor="middle" x="10269.5" y="-749.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 10</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer_11</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="10779.5,-560.5 10779.5,-681.5 11643,-681.5 11643,-560.5 10779.5,-560.5"/>
<text text-anchor="middle" x="11211.25" y="-667.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 11</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer_12</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="11723.5,-475.5 11723.5,-596.5 12587,-596.5 12587,-475.5 11723.5,-475.5"/>
<text text-anchor="middle" x="12155.25" y="-582.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 12</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer_13</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="12667.5,-396.5 12667.5,-517.5 13531,-517.5 13531,-396.5 12667.5,-396.5"/>
<text text-anchor="middle" x="13099.25" y="-503.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 13</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer_14</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="13611.5,-335.5 13611.5,-456.5 14475,-456.5 14475,-335.5 13611.5,-335.5"/>
<text text-anchor="middle" x="14043.25" y="-442.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 14</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer_15</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="14555.5,-250.5 14555.5,-371.5 15419,-371.5 15419,-250.5 14555.5,-250.5"/>
<text text-anchor="middle" x="14987.25" y="-357.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 15</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_layer_16</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="15499.5,-195.5 15499.5,-316.5 16363,-316.5 16363,-195.5 15499.5,-195.5"/>
<text text-anchor="middle" x="15931.25" y="-302.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 16</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_layer_17</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="16443.5,-113.5 16443.5,-234.5 17307,-234.5 17307,-113.5 16443.5,-113.5"/>
<text text-anchor="middle" x="16875.25" y="-220.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 17</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_layer_18</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="17387.5,-35.5 17387.5,-156.5 18251,-156.5 18251,-35.5 17387.5,-35.5"/>
<text text-anchor="middle" x="17819.25" y="-142.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 18</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_layer_19</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="18331.5,-29.5 18331.5,-150.5 19195,-150.5 19195,-29.5 18331.5,-29.5"/>
<text text-anchor="middle" x="18763.25" y="-136.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 19</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_layer_20</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="19275.5,-26.5 19275.5,-147.5 20139,-147.5 20139,-26.5 19275.5,-26.5"/>
<text text-anchor="middle" x="19707.25" y="-133.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 20</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_layer_21</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="20219.5,-24.5 20219.5,-145.5 21083,-145.5 21083,-24.5 20219.5,-24.5"/>
<text text-anchor="middle" x="20651.25" y="-131.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 21</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_layer_22</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="21163.5,-24.5 21163.5,-145.5 22027,-145.5 22027,-24.5 21163.5,-24.5"/>
<text text-anchor="middle" x="21595.25" y="-131.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 22</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_layer_23</title>
<polygon fill="#e5e9f2" stroke="#e5e9f2" points="22107.5,-24.5 22107.5,-145.5 22971,-145.5 22971,-24.5 22107.5,-24.5"/>
<text text-anchor="middle" x="22539.25" y="-131.9" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="12.00">TransformerBlock 23</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="#d8e6f3" stroke="black" points="158,-1481.5 0,-1481.5 0,-1443.5 158,-1443.5 158,-1481.5"/>
<text text-anchor="middle" x="79" y="-1466.3" font-family="Times,serif" font-size="14.00">Input Tokens</text>
<text text-anchor="middle" x="79" y="-1451.3" font-family="Times,serif" font-size="14.00">(max_seq_len 4096)</text>
</g>
<!-- embed -->
<g id="node2" class="node">
<title>embed</title>
<polygon fill="#f4f6f8" stroke="black" points="195,-1443.5 195,-1481.5 434,-1481.5 434,-1443.5 195,-1443.5"/>
<text text-anchor="middle" x="314.5" y="-1466.3" font-family="Times,serif" font-size="14.00">TokenEmbedding</text>
<text text-anchor="middle" x="314.5" y="-1451.3" font-family="Times,serif" font-size="14.00">(vocab 50257 â†’ d_model 1024)</text>
</g>
<!-- input&#45;&gt;embed -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed</title>
<path fill="none" stroke="black" d="M158.08,-1462.5C166.65,-1462.5 175.54,-1462.5 184.52,-1462.5"/>
<polygon fill="black" stroke="black" points="184.69,-1466 194.69,-1462.5 184.69,-1459 184.69,-1466"/>
</g>
<!-- norm_attn_0 -->
<g id="node3" class="node">
<title>norm_attn_0</title>
<polygon fill="#ffffff" stroke="black" points="512,-1444.5 512,-1480.5 604,-1480.5 604,-1444.5 512,-1444.5"/>
<text text-anchor="middle" x="558" y="-1458.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- embed&#45;&gt;norm_attn_0 -->
<g id="edge7" class="edge">
<title>embed&#45;&gt;norm_attn_0</title>
<path fill="none" stroke="black" d="M434.13,-1462.5C457.69,-1462.5 481.37,-1462.5 501.56,-1462.5"/>
<polygon fill="black" stroke="black" points="501.78,-1466 511.78,-1462.5 501.78,-1459 501.78,-1466"/>
<text text-anchor="middle" x="473" y="-1465.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_0 -->
<g id="node4" class="node">
<title>attn_0</title>
<polygon fill="#ffffff" stroke="black" points="641,-1421 641,-1504 806,-1504 806,-1421 641,-1421"/>
<text text-anchor="middle" x="723.5" y="-1488.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="723.5" y="-1473.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="723.5" y="-1458.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="723.5" y="-1443.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="723.5" y="-1428.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_0&#45;&gt;attn_0 -->
<g id="edge2" class="edge">
<title>norm_attn_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M604.11,-1462.5C612.51,-1462.5 621.56,-1462.5 630.78,-1462.5"/>
<polygon fill="black" stroke="black" points="630.83,-1466 640.83,-1462.5 630.83,-1459 630.83,-1466"/>
</g>
<!-- drop_attn_0 -->
<g id="node5" class="node">
<title>drop_attn_0</title>
<polygon fill="#ffffff" stroke="black" points="843,-1444.5 843,-1480.5 918,-1480.5 918,-1444.5 843,-1444.5"/>
<text text-anchor="middle" x="880.5" y="-1458.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_0&#45;&gt;drop_attn_0 -->
<g id="edge3" class="edge">
<title>attn_0&#45;&gt;drop_attn_0</title>
<path fill="none" stroke="black" d="M806.09,-1462.5C815.21,-1462.5 824.26,-1462.5 832.73,-1462.5"/>
<polygon fill="black" stroke="black" points="832.73,-1466 842.73,-1462.5 832.73,-1459 832.73,-1466"/>
</g>
<!-- norm_ffn_0 -->
<g id="node6" class="node">
<title>norm_ffn_0</title>
<polygon fill="#ffffff" stroke="black" points="955,-1444.5 955,-1480.5 1047,-1480.5 1047,-1444.5 955,-1444.5"/>
<text text-anchor="middle" x="1001" y="-1458.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_0&#45;&gt;norm_ffn_0 -->
<g id="edge4" class="edge">
<title>drop_attn_0&#45;&gt;norm_ffn_0</title>
<path fill="none" stroke="black" d="M918.02,-1462.5C926.42,-1462.5 935.54,-1462.5 944.54,-1462.5"/>
<polygon fill="black" stroke="black" points="944.61,-1466 954.61,-1462.5 944.61,-1459 944.61,-1466"/>
</g>
<!-- ffn_0 -->
<g id="node7" class="node">
<title>ffn_0</title>
<polygon fill="#ffffff" stroke="black" points="1084,-1443.5 1084,-1481.5 1229,-1481.5 1229,-1443.5 1084,-1443.5"/>
<text text-anchor="middle" x="1156.5" y="-1466.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="1156.5" y="-1451.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_0&#45;&gt;ffn_0 -->
<g id="edge5" class="edge">
<title>norm_ffn_0&#45;&gt;ffn_0</title>
<path fill="none" stroke="black" d="M1047.22,-1462.5C1055.58,-1462.5 1064.53,-1462.5 1073.59,-1462.5"/>
<polygon fill="black" stroke="black" points="1073.82,-1466 1083.82,-1462.5 1073.82,-1459 1073.82,-1466"/>
</g>
<!-- drop_ffn_0 -->
<g id="node8" class="node">
<title>drop_ffn_0</title>
<polygon fill="#ffffff" stroke="black" points="1266,-1444.5 1266,-1480.5 1341,-1480.5 1341,-1444.5 1266,-1444.5"/>
<text text-anchor="middle" x="1303.5" y="-1458.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_0&#45;&gt;drop_ffn_0 -->
<g id="edge6" class="edge">
<title>ffn_0&#45;&gt;drop_ffn_0</title>
<path fill="none" stroke="black" d="M1229.15,-1462.5C1238.18,-1462.5 1247.23,-1462.5 1255.73,-1462.5"/>
<polygon fill="black" stroke="black" points="1255.8,-1466 1265.8,-1462.5 1255.8,-1459 1255.8,-1466"/>
</g>
<!-- residual_out_0 -->
<g id="node9" class="node">
<title>residual_out_0</title>
<polygon fill="#f4f6f8" stroke="black" points="1419,-1472.5 1419,-1508.5 1539,-1508.5 1539,-1472.5 1419,-1472.5"/>
<text text-anchor="middle" x="1479" y="-1486.8" font-family="Times,serif" font-size="14.00">residual_out_0</text>
</g>
<!-- drop_ffn_0&#45;&gt;residual_out_0 -->
<!-- norm_attn_1 -->
<g id="node10" class="node">
<title>norm_attn_1</title>
<polygon fill="#ffffff" stroke="black" points="1433,-1391.5 1433,-1427.5 1525,-1427.5 1525,-1391.5 1433,-1391.5"/>
<text text-anchor="middle" x="1479" y="-1405.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_0&#45;&gt;norm_attn_1 -->
<g id="edge15" class="edge">
<title>drop_ffn_0&#45;&gt;norm_attn_1</title>
<path fill="none" stroke="black" d="M1341.29,-1451.26C1365.13,-1443.98 1396.59,-1434.37 1423.32,-1426.2"/>
<polygon fill="black" stroke="black" points="1424.39,-1429.54 1432.93,-1423.27 1422.35,-1422.84 1424.39,-1429.54"/>
<text text-anchor="middle" x="1380" y="-1447.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_1 -->
<g id="node11" class="node">
<title>attn_1</title>
<polygon fill="#ffffff" stroke="black" points="1576,-1351 1576,-1434 1741,-1434 1741,-1351 1576,-1351"/>
<text text-anchor="middle" x="1658.5" y="-1418.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="1658.5" y="-1403.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="1658.5" y="-1388.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="1658.5" y="-1373.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="1658.5" y="-1358.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_1&#45;&gt;attn_1 -->
<g id="edge10" class="edge">
<title>norm_attn_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M1525.25,-1405.17C1537.65,-1403.98 1551.55,-1402.65 1565.56,-1401.31"/>
<polygon fill="black" stroke="black" points="1566.14,-1404.77 1575.76,-1400.33 1565.47,-1397.8 1566.14,-1404.77"/>
</g>
<!-- drop_attn_1 -->
<g id="node12" class="node">
<title>drop_attn_1</title>
<polygon fill="#ffffff" stroke="black" points="1778,-1374.5 1778,-1410.5 1853,-1410.5 1853,-1374.5 1778,-1374.5"/>
<text text-anchor="middle" x="1815.5" y="-1388.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_1&#45;&gt;drop_attn_1 -->
<g id="edge11" class="edge">
<title>attn_1&#45;&gt;drop_attn_1</title>
<path fill="none" stroke="black" d="M1741.09,-1392.5C1750.21,-1392.5 1759.26,-1392.5 1767.73,-1392.5"/>
<polygon fill="black" stroke="black" points="1767.73,-1396 1777.73,-1392.5 1767.73,-1389 1767.73,-1396"/>
</g>
<!-- norm_ffn_1 -->
<g id="node13" class="node">
<title>norm_ffn_1</title>
<polygon fill="#ffffff" stroke="black" points="1890,-1374.5 1890,-1410.5 1982,-1410.5 1982,-1374.5 1890,-1374.5"/>
<text text-anchor="middle" x="1936" y="-1388.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_1&#45;&gt;norm_ffn_1 -->
<g id="edge12" class="edge">
<title>drop_attn_1&#45;&gt;norm_ffn_1</title>
<path fill="none" stroke="black" d="M1853.02,-1392.5C1861.42,-1392.5 1870.54,-1392.5 1879.54,-1392.5"/>
<polygon fill="black" stroke="black" points="1879.61,-1396 1889.61,-1392.5 1879.61,-1389 1879.61,-1396"/>
</g>
<!-- ffn_1 -->
<g id="node14" class="node">
<title>ffn_1</title>
<polygon fill="#ffffff" stroke="black" points="2019,-1373.5 2019,-1411.5 2164,-1411.5 2164,-1373.5 2019,-1373.5"/>
<text text-anchor="middle" x="2091.5" y="-1396.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="2091.5" y="-1381.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_1&#45;&gt;ffn_1 -->
<g id="edge13" class="edge">
<title>norm_ffn_1&#45;&gt;ffn_1</title>
<path fill="none" stroke="black" d="M1982.22,-1392.5C1990.58,-1392.5 1999.53,-1392.5 2008.59,-1392.5"/>
<polygon fill="black" stroke="black" points="2008.82,-1396 2018.82,-1392.5 2008.82,-1389 2008.82,-1396"/>
</g>
<!-- drop_ffn_1 -->
<g id="node15" class="node">
<title>drop_ffn_1</title>
<polygon fill="#ffffff" stroke="black" points="2201,-1374.5 2201,-1410.5 2276,-1410.5 2276,-1374.5 2201,-1374.5"/>
<text text-anchor="middle" x="2238.5" y="-1388.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_1&#45;&gt;drop_ffn_1 -->
<g id="edge14" class="edge">
<title>ffn_1&#45;&gt;drop_ffn_1</title>
<path fill="none" stroke="black" d="M2164.15,-1392.5C2173.18,-1392.5 2182.23,-1392.5 2190.73,-1392.5"/>
<polygon fill="black" stroke="black" points="2190.8,-1396 2200.8,-1392.5 2190.8,-1389 2190.8,-1396"/>
</g>
<!-- residual_out_1 -->
<g id="node16" class="node">
<title>residual_out_1</title>
<polygon fill="#f4f6f8" stroke="black" points="2354,-1399.5 2354,-1435.5 2474,-1435.5 2474,-1399.5 2354,-1399.5"/>
<text text-anchor="middle" x="2414" y="-1413.8" font-family="Times,serif" font-size="14.00">residual_out_1</text>
</g>
<!-- drop_ffn_1&#45;&gt;residual_out_1 -->
<!-- norm_attn_2 -->
<g id="node17" class="node">
<title>norm_attn_2</title>
<polygon fill="#ffffff" stroke="black" points="2368,-1318.5 2368,-1354.5 2460,-1354.5 2460,-1318.5 2368,-1318.5"/>
<text text-anchor="middle" x="2414" y="-1332.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_1&#45;&gt;norm_attn_2 -->
<g id="edge23" class="edge">
<title>drop_ffn_1&#45;&gt;norm_attn_2</title>
<path fill="none" stroke="black" d="M2276.29,-1380.62C2300.13,-1372.93 2331.59,-1362.78 2358.32,-1354.15"/>
<polygon fill="black" stroke="black" points="2359.49,-1357.45 2367.93,-1351.05 2357.34,-1350.79 2359.49,-1357.45"/>
<text text-anchor="middle" x="2315" y="-1377.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_2 -->
<g id="node18" class="node">
<title>attn_2</title>
<polygon fill="#ffffff" stroke="black" points="2511,-1278 2511,-1361 2676,-1361 2676,-1278 2511,-1278"/>
<text text-anchor="middle" x="2593.5" y="-1345.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="2593.5" y="-1330.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="2593.5" y="-1315.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="2593.5" y="-1300.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="2593.5" y="-1285.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_2&#45;&gt;attn_2 -->
<g id="edge18" class="edge">
<title>norm_attn_2&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M2460.25,-1332.17C2472.65,-1330.98 2486.55,-1329.65 2500.56,-1328.31"/>
<polygon fill="black" stroke="black" points="2501.14,-1331.77 2510.76,-1327.33 2500.47,-1324.8 2501.14,-1331.77"/>
</g>
<!-- drop_attn_2 -->
<g id="node19" class="node">
<title>drop_attn_2</title>
<polygon fill="#ffffff" stroke="black" points="2713,-1301.5 2713,-1337.5 2788,-1337.5 2788,-1301.5 2713,-1301.5"/>
<text text-anchor="middle" x="2750.5" y="-1315.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_2&#45;&gt;drop_attn_2 -->
<g id="edge19" class="edge">
<title>attn_2&#45;&gt;drop_attn_2</title>
<path fill="none" stroke="black" d="M2676.09,-1319.5C2685.21,-1319.5 2694.26,-1319.5 2702.73,-1319.5"/>
<polygon fill="black" stroke="black" points="2702.73,-1323 2712.73,-1319.5 2702.73,-1316 2702.73,-1323"/>
</g>
<!-- norm_ffn_2 -->
<g id="node20" class="node">
<title>norm_ffn_2</title>
<polygon fill="#ffffff" stroke="black" points="2825,-1301.5 2825,-1337.5 2917,-1337.5 2917,-1301.5 2825,-1301.5"/>
<text text-anchor="middle" x="2871" y="-1315.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_2&#45;&gt;norm_ffn_2 -->
<g id="edge20" class="edge">
<title>drop_attn_2&#45;&gt;norm_ffn_2</title>
<path fill="none" stroke="black" d="M2788.02,-1319.5C2796.42,-1319.5 2805.54,-1319.5 2814.54,-1319.5"/>
<polygon fill="black" stroke="black" points="2814.61,-1323 2824.61,-1319.5 2814.61,-1316 2814.61,-1323"/>
</g>
<!-- ffn_2 -->
<g id="node21" class="node">
<title>ffn_2</title>
<polygon fill="#ffffff" stroke="black" points="2954,-1300.5 2954,-1338.5 3099,-1338.5 3099,-1300.5 2954,-1300.5"/>
<text text-anchor="middle" x="3026.5" y="-1323.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="3026.5" y="-1308.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_2&#45;&gt;ffn_2 -->
<g id="edge21" class="edge">
<title>norm_ffn_2&#45;&gt;ffn_2</title>
<path fill="none" stroke="black" d="M2917.22,-1319.5C2925.58,-1319.5 2934.53,-1319.5 2943.59,-1319.5"/>
<polygon fill="black" stroke="black" points="2943.82,-1323 2953.82,-1319.5 2943.82,-1316 2943.82,-1323"/>
</g>
<!-- drop_ffn_2 -->
<g id="node22" class="node">
<title>drop_ffn_2</title>
<polygon fill="#ffffff" stroke="black" points="3136,-1301.5 3136,-1337.5 3211,-1337.5 3211,-1301.5 3136,-1301.5"/>
<text text-anchor="middle" x="3173.5" y="-1315.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_2&#45;&gt;drop_ffn_2 -->
<g id="edge22" class="edge">
<title>ffn_2&#45;&gt;drop_ffn_2</title>
<path fill="none" stroke="black" d="M3099.15,-1319.5C3108.18,-1319.5 3117.23,-1319.5 3125.73,-1319.5"/>
<polygon fill="black" stroke="black" points="3125.8,-1323 3135.8,-1319.5 3125.8,-1316 3125.8,-1323"/>
</g>
<!-- residual_out_2 -->
<g id="node23" class="node">
<title>residual_out_2</title>
<polygon fill="#f4f6f8" stroke="black" points="3289,-1314.5 3289,-1350.5 3409,-1350.5 3409,-1314.5 3289,-1314.5"/>
<text text-anchor="middle" x="3349" y="-1328.8" font-family="Times,serif" font-size="14.00">residual_out_2</text>
</g>
<!-- drop_ffn_2&#45;&gt;residual_out_2 -->
<!-- norm_attn_3 -->
<g id="node24" class="node">
<title>norm_attn_3</title>
<polygon fill="#ffffff" stroke="black" points="3303,-1233.5 3303,-1269.5 3395,-1269.5 3395,-1233.5 3303,-1233.5"/>
<text text-anchor="middle" x="3349" y="-1247.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_2&#45;&gt;norm_attn_3 -->
<g id="edge31" class="edge">
<title>drop_ffn_2&#45;&gt;norm_attn_3</title>
<path fill="none" stroke="black" d="M3211.29,-1305.08C3235.13,-1295.74 3266.59,-1283.41 3293.32,-1272.93"/>
<polygon fill="black" stroke="black" points="3294.9,-1276.07 3302.93,-1269.16 3292.34,-1269.55 3294.9,-1276.07"/>
<text text-anchor="middle" x="3250" y="-1301.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_3 -->
<g id="node25" class="node">
<title>attn_3</title>
<polygon fill="#ffffff" stroke="black" points="3446,-1193 3446,-1276 3611,-1276 3611,-1193 3446,-1193"/>
<text text-anchor="middle" x="3528.5" y="-1260.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="3528.5" y="-1245.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="3528.5" y="-1230.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="3528.5" y="-1215.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="3528.5" y="-1200.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_3&#45;&gt;attn_3 -->
<g id="edge26" class="edge">
<title>norm_attn_3&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M3395.25,-1247.17C3407.65,-1245.98 3421.55,-1244.65 3435.56,-1243.31"/>
<polygon fill="black" stroke="black" points="3436.14,-1246.77 3445.76,-1242.33 3435.47,-1239.8 3436.14,-1246.77"/>
</g>
<!-- drop_attn_3 -->
<g id="node26" class="node">
<title>drop_attn_3</title>
<polygon fill="#ffffff" stroke="black" points="3648,-1216.5 3648,-1252.5 3723,-1252.5 3723,-1216.5 3648,-1216.5"/>
<text text-anchor="middle" x="3685.5" y="-1230.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_3&#45;&gt;drop_attn_3 -->
<g id="edge27" class="edge">
<title>attn_3&#45;&gt;drop_attn_3</title>
<path fill="none" stroke="black" d="M3611.09,-1234.5C3620.21,-1234.5 3629.26,-1234.5 3637.73,-1234.5"/>
<polygon fill="black" stroke="black" points="3637.73,-1238 3647.73,-1234.5 3637.73,-1231 3637.73,-1238"/>
</g>
<!-- norm_ffn_3 -->
<g id="node27" class="node">
<title>norm_ffn_3</title>
<polygon fill="#ffffff" stroke="black" points="3760,-1216.5 3760,-1252.5 3852,-1252.5 3852,-1216.5 3760,-1216.5"/>
<text text-anchor="middle" x="3806" y="-1230.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_3&#45;&gt;norm_ffn_3 -->
<g id="edge28" class="edge">
<title>drop_attn_3&#45;&gt;norm_ffn_3</title>
<path fill="none" stroke="black" d="M3723.02,-1234.5C3731.42,-1234.5 3740.54,-1234.5 3749.54,-1234.5"/>
<polygon fill="black" stroke="black" points="3749.61,-1238 3759.61,-1234.5 3749.61,-1231 3749.61,-1238"/>
</g>
<!-- ffn_3 -->
<g id="node28" class="node">
<title>ffn_3</title>
<polygon fill="#ffffff" stroke="black" points="3889,-1215.5 3889,-1253.5 4034,-1253.5 4034,-1215.5 3889,-1215.5"/>
<text text-anchor="middle" x="3961.5" y="-1238.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="3961.5" y="-1223.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_3&#45;&gt;ffn_3 -->
<g id="edge29" class="edge">
<title>norm_ffn_3&#45;&gt;ffn_3</title>
<path fill="none" stroke="black" d="M3852.22,-1234.5C3860.58,-1234.5 3869.53,-1234.5 3878.59,-1234.5"/>
<polygon fill="black" stroke="black" points="3878.82,-1238 3888.82,-1234.5 3878.82,-1231 3878.82,-1238"/>
</g>
<!-- drop_ffn_3 -->
<g id="node29" class="node">
<title>drop_ffn_3</title>
<polygon fill="#ffffff" stroke="black" points="4071,-1216.5 4071,-1252.5 4146,-1252.5 4146,-1216.5 4071,-1216.5"/>
<text text-anchor="middle" x="4108.5" y="-1230.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_3&#45;&gt;drop_ffn_3 -->
<g id="edge30" class="edge">
<title>ffn_3&#45;&gt;drop_ffn_3</title>
<path fill="none" stroke="black" d="M4034.15,-1234.5C4043.18,-1234.5 4052.23,-1234.5 4060.73,-1234.5"/>
<polygon fill="black" stroke="black" points="4060.8,-1238 4070.8,-1234.5 4060.8,-1231 4060.8,-1238"/>
</g>
<!-- residual_out_3 -->
<g id="node30" class="node">
<title>residual_out_3</title>
<polygon fill="#f4f6f8" stroke="black" points="4224,-1259.5 4224,-1295.5 4344,-1295.5 4344,-1259.5 4224,-1259.5"/>
<text text-anchor="middle" x="4284" y="-1273.8" font-family="Times,serif" font-size="14.00">residual_out_3</text>
</g>
<!-- drop_ffn_3&#45;&gt;residual_out_3 -->
<!-- norm_attn_4 -->
<g id="node31" class="node">
<title>norm_attn_4</title>
<polygon fill="#ffffff" stroke="black" points="4238,-1173.5 4238,-1209.5 4330,-1209.5 4330,-1173.5 4238,-1173.5"/>
<text text-anchor="middle" x="4284" y="-1187.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_3&#45;&gt;norm_attn_4 -->
<g id="edge39" class="edge">
<title>drop_ffn_3&#45;&gt;norm_attn_4</title>
<path fill="none" stroke="black" d="M4146.29,-1225.38C4170.02,-1219.5 4201.31,-1211.75 4227.97,-1205.14"/>
<polygon fill="black" stroke="black" points="4229.07,-1208.47 4237.93,-1202.67 4227.38,-1201.68 4229.07,-1208.47"/>
<text text-anchor="middle" x="4185" y="-1224.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_4 -->
<g id="node32" class="node">
<title>attn_4</title>
<polygon fill="#ffffff" stroke="black" points="4381,-1138 4381,-1221 4546,-1221 4546,-1138 4381,-1138"/>
<text text-anchor="middle" x="4463.5" y="-1205.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="4463.5" y="-1190.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="4463.5" y="-1175.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="4463.5" y="-1160.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="4463.5" y="-1145.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_4&#45;&gt;attn_4 -->
<g id="edge34" class="edge">
<title>norm_attn_4&#45;&gt;attn_4</title>
<path fill="none" stroke="black" d="M4330.25,-1188.44C4342.65,-1187.6 4356.55,-1186.66 4370.56,-1185.72"/>
<polygon fill="black" stroke="black" points="4371.02,-1189.19 4380.76,-1185.03 4370.54,-1182.21 4371.02,-1189.19"/>
</g>
<!-- drop_attn_4 -->
<g id="node33" class="node">
<title>drop_attn_4</title>
<polygon fill="#ffffff" stroke="black" points="4583,-1161.5 4583,-1197.5 4658,-1197.5 4658,-1161.5 4583,-1161.5"/>
<text text-anchor="middle" x="4620.5" y="-1175.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_4&#45;&gt;drop_attn_4 -->
<g id="edge35" class="edge">
<title>attn_4&#45;&gt;drop_attn_4</title>
<path fill="none" stroke="black" d="M4546.09,-1179.5C4555.21,-1179.5 4564.26,-1179.5 4572.73,-1179.5"/>
<polygon fill="black" stroke="black" points="4572.73,-1183 4582.73,-1179.5 4572.73,-1176 4572.73,-1183"/>
</g>
<!-- norm_ffn_4 -->
<g id="node34" class="node">
<title>norm_ffn_4</title>
<polygon fill="#ffffff" stroke="black" points="4695,-1161.5 4695,-1197.5 4787,-1197.5 4787,-1161.5 4695,-1161.5"/>
<text text-anchor="middle" x="4741" y="-1175.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_4&#45;&gt;norm_ffn_4 -->
<g id="edge36" class="edge">
<title>drop_attn_4&#45;&gt;norm_ffn_4</title>
<path fill="none" stroke="black" d="M4658.02,-1179.5C4666.42,-1179.5 4675.54,-1179.5 4684.54,-1179.5"/>
<polygon fill="black" stroke="black" points="4684.61,-1183 4694.61,-1179.5 4684.61,-1176 4684.61,-1183"/>
</g>
<!-- ffn_4 -->
<g id="node35" class="node">
<title>ffn_4</title>
<polygon fill="#ffffff" stroke="black" points="4824,-1160.5 4824,-1198.5 4969,-1198.5 4969,-1160.5 4824,-1160.5"/>
<text text-anchor="middle" x="4896.5" y="-1183.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="4896.5" y="-1168.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_4&#45;&gt;ffn_4 -->
<g id="edge37" class="edge">
<title>norm_ffn_4&#45;&gt;ffn_4</title>
<path fill="none" stroke="black" d="M4787.22,-1179.5C4795.58,-1179.5 4804.53,-1179.5 4813.59,-1179.5"/>
<polygon fill="black" stroke="black" points="4813.82,-1183 4823.82,-1179.5 4813.82,-1176 4813.82,-1183"/>
</g>
<!-- drop_ffn_4 -->
<g id="node36" class="node">
<title>drop_ffn_4</title>
<polygon fill="#ffffff" stroke="black" points="5006,-1161.5 5006,-1197.5 5081,-1197.5 5081,-1161.5 5006,-1161.5"/>
<text text-anchor="middle" x="5043.5" y="-1175.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_4&#45;&gt;drop_ffn_4 -->
<g id="edge38" class="edge">
<title>ffn_4&#45;&gt;drop_ffn_4</title>
<path fill="none" stroke="black" d="M4969.15,-1179.5C4978.18,-1179.5 4987.23,-1179.5 4995.73,-1179.5"/>
<polygon fill="black" stroke="black" points="4995.8,-1183 5005.8,-1179.5 4995.8,-1176 4995.8,-1183"/>
</g>
<!-- residual_out_4 -->
<g id="node37" class="node">
<title>residual_out_4</title>
<polygon fill="#f4f6f8" stroke="black" points="5159,-1177.5 5159,-1213.5 5279,-1213.5 5279,-1177.5 5159,-1177.5"/>
<text text-anchor="middle" x="5219" y="-1191.8" font-family="Times,serif" font-size="14.00">residual_out_4</text>
</g>
<!-- drop_ffn_4&#45;&gt;residual_out_4 -->
<!-- norm_attn_5 -->
<g id="node38" class="node">
<title>norm_attn_5</title>
<polygon fill="#ffffff" stroke="black" points="5173,-1096.5 5173,-1132.5 5265,-1132.5 5265,-1096.5 5173,-1096.5"/>
<text text-anchor="middle" x="5219" y="-1110.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_4&#45;&gt;norm_attn_5 -->
<g id="edge47" class="edge">
<title>drop_ffn_4&#45;&gt;norm_attn_5</title>
<path fill="none" stroke="black" d="M5081.29,-1165.72C5105.13,-1156.79 5136.59,-1145 5163.32,-1134.99"/>
<polygon fill="black" stroke="black" points="5164.79,-1138.17 5172.93,-1131.38 5162.34,-1131.62 5164.79,-1138.17"/>
<text text-anchor="middle" x="5120" y="-1161.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_5 -->
<g id="node39" class="node">
<title>attn_5</title>
<polygon fill="#ffffff" stroke="black" points="5316,-1056 5316,-1139 5481,-1139 5481,-1056 5316,-1056"/>
<text text-anchor="middle" x="5398.5" y="-1123.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="5398.5" y="-1108.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="5398.5" y="-1093.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="5398.5" y="-1078.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="5398.5" y="-1063.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_5&#45;&gt;attn_5 -->
<g id="edge42" class="edge">
<title>norm_attn_5&#45;&gt;attn_5</title>
<path fill="none" stroke="black" d="M5265.25,-1110.17C5277.65,-1108.98 5291.55,-1107.65 5305.56,-1106.31"/>
<polygon fill="black" stroke="black" points="5306.14,-1109.77 5315.76,-1105.33 5305.47,-1102.8 5306.14,-1109.77"/>
</g>
<!-- drop_attn_5 -->
<g id="node40" class="node">
<title>drop_attn_5</title>
<polygon fill="#ffffff" stroke="black" points="5518,-1079.5 5518,-1115.5 5593,-1115.5 5593,-1079.5 5518,-1079.5"/>
<text text-anchor="middle" x="5555.5" y="-1093.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_5&#45;&gt;drop_attn_5 -->
<g id="edge43" class="edge">
<title>attn_5&#45;&gt;drop_attn_5</title>
<path fill="none" stroke="black" d="M5481.09,-1097.5C5490.21,-1097.5 5499.26,-1097.5 5507.73,-1097.5"/>
<polygon fill="black" stroke="black" points="5507.73,-1101 5517.73,-1097.5 5507.73,-1094 5507.73,-1101"/>
</g>
<!-- norm_ffn_5 -->
<g id="node41" class="node">
<title>norm_ffn_5</title>
<polygon fill="#ffffff" stroke="black" points="5630,-1079.5 5630,-1115.5 5722,-1115.5 5722,-1079.5 5630,-1079.5"/>
<text text-anchor="middle" x="5676" y="-1093.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_5&#45;&gt;norm_ffn_5 -->
<g id="edge44" class="edge">
<title>drop_attn_5&#45;&gt;norm_ffn_5</title>
<path fill="none" stroke="black" d="M5593.02,-1097.5C5601.42,-1097.5 5610.54,-1097.5 5619.54,-1097.5"/>
<polygon fill="black" stroke="black" points="5619.61,-1101 5629.61,-1097.5 5619.61,-1094 5619.61,-1101"/>
</g>
<!-- ffn_5 -->
<g id="node42" class="node">
<title>ffn_5</title>
<polygon fill="#ffffff" stroke="black" points="5759,-1078.5 5759,-1116.5 5904,-1116.5 5904,-1078.5 5759,-1078.5"/>
<text text-anchor="middle" x="5831.5" y="-1101.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="5831.5" y="-1086.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_5&#45;&gt;ffn_5 -->
<g id="edge45" class="edge">
<title>norm_ffn_5&#45;&gt;ffn_5</title>
<path fill="none" stroke="black" d="M5722.22,-1097.5C5730.58,-1097.5 5739.53,-1097.5 5748.59,-1097.5"/>
<polygon fill="black" stroke="black" points="5748.82,-1101 5758.82,-1097.5 5748.82,-1094 5748.82,-1101"/>
</g>
<!-- drop_ffn_5 -->
<g id="node43" class="node">
<title>drop_ffn_5</title>
<polygon fill="#ffffff" stroke="black" points="5941,-1079.5 5941,-1115.5 6016,-1115.5 6016,-1079.5 5941,-1079.5"/>
<text text-anchor="middle" x="5978.5" y="-1093.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_5&#45;&gt;drop_ffn_5 -->
<g id="edge46" class="edge">
<title>ffn_5&#45;&gt;drop_ffn_5</title>
<path fill="none" stroke="black" d="M5904.15,-1097.5C5913.18,-1097.5 5922.23,-1097.5 5930.73,-1097.5"/>
<polygon fill="black" stroke="black" points="5930.8,-1101 5940.8,-1097.5 5930.8,-1094 5930.8,-1101"/>
</g>
<!-- residual_out_5 -->
<g id="node44" class="node">
<title>residual_out_5</title>
<polygon fill="#f4f6f8" stroke="black" points="6094,-1093.5 6094,-1129.5 6214,-1129.5 6214,-1093.5 6094,-1093.5"/>
<text text-anchor="middle" x="6154" y="-1107.8" font-family="Times,serif" font-size="14.00">residual_out_5</text>
</g>
<!-- drop_ffn_5&#45;&gt;residual_out_5 -->
<!-- norm_attn_6 -->
<g id="node45" class="node">
<title>norm_attn_6</title>
<polygon fill="#ffffff" stroke="black" points="6108,-1012.5 6108,-1048.5 6200,-1048.5 6200,-1012.5 6108,-1012.5"/>
<text text-anchor="middle" x="6154" y="-1026.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_5&#45;&gt;norm_attn_6 -->
<g id="edge55" class="edge">
<title>drop_ffn_5&#45;&gt;norm_attn_6</title>
<path fill="none" stroke="black" d="M6016.29,-1083.29C6040.13,-1074.09 6071.59,-1061.94 6098.32,-1051.62"/>
<polygon fill="black" stroke="black" points="6099.86,-1054.77 6107.93,-1047.9 6097.34,-1048.24 6099.86,-1054.77"/>
<text text-anchor="middle" x="6055" y="-1079.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_6 -->
<g id="node46" class="node">
<title>attn_6</title>
<polygon fill="#ffffff" stroke="black" points="6251,-972 6251,-1055 6416,-1055 6416,-972 6251,-972"/>
<text text-anchor="middle" x="6333.5" y="-1039.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="6333.5" y="-1024.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="6333.5" y="-1009.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="6333.5" y="-994.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="6333.5" y="-979.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_6&#45;&gt;attn_6 -->
<g id="edge50" class="edge">
<title>norm_attn_6&#45;&gt;attn_6</title>
<path fill="none" stroke="black" d="M6200.25,-1026.17C6212.65,-1024.98 6226.55,-1023.65 6240.56,-1022.31"/>
<polygon fill="black" stroke="black" points="6241.14,-1025.77 6250.76,-1021.33 6240.47,-1018.8 6241.14,-1025.77"/>
</g>
<!-- drop_attn_6 -->
<g id="node47" class="node">
<title>drop_attn_6</title>
<polygon fill="#ffffff" stroke="black" points="6453,-995.5 6453,-1031.5 6528,-1031.5 6528,-995.5 6453,-995.5"/>
<text text-anchor="middle" x="6490.5" y="-1009.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_6&#45;&gt;drop_attn_6 -->
<g id="edge51" class="edge">
<title>attn_6&#45;&gt;drop_attn_6</title>
<path fill="none" stroke="black" d="M6416.09,-1013.5C6425.21,-1013.5 6434.26,-1013.5 6442.73,-1013.5"/>
<polygon fill="black" stroke="black" points="6442.73,-1017 6452.73,-1013.5 6442.73,-1010 6442.73,-1017"/>
</g>
<!-- norm_ffn_6 -->
<g id="node48" class="node">
<title>norm_ffn_6</title>
<polygon fill="#ffffff" stroke="black" points="6565,-995.5 6565,-1031.5 6657,-1031.5 6657,-995.5 6565,-995.5"/>
<text text-anchor="middle" x="6611" y="-1009.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_6&#45;&gt;norm_ffn_6 -->
<g id="edge52" class="edge">
<title>drop_attn_6&#45;&gt;norm_ffn_6</title>
<path fill="none" stroke="black" d="M6528.02,-1013.5C6536.42,-1013.5 6545.54,-1013.5 6554.54,-1013.5"/>
<polygon fill="black" stroke="black" points="6554.61,-1017 6564.61,-1013.5 6554.61,-1010 6554.61,-1017"/>
</g>
<!-- ffn_6 -->
<g id="node49" class="node">
<title>ffn_6</title>
<polygon fill="#ffffff" stroke="black" points="6694,-994.5 6694,-1032.5 6839,-1032.5 6839,-994.5 6694,-994.5"/>
<text text-anchor="middle" x="6766.5" y="-1017.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="6766.5" y="-1002.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_6&#45;&gt;ffn_6 -->
<g id="edge53" class="edge">
<title>norm_ffn_6&#45;&gt;ffn_6</title>
<path fill="none" stroke="black" d="M6657.22,-1013.5C6665.58,-1013.5 6674.53,-1013.5 6683.59,-1013.5"/>
<polygon fill="black" stroke="black" points="6683.82,-1017 6693.82,-1013.5 6683.82,-1010 6683.82,-1017"/>
</g>
<!-- drop_ffn_6 -->
<g id="node50" class="node">
<title>drop_ffn_6</title>
<polygon fill="#ffffff" stroke="black" points="6876,-995.5 6876,-1031.5 6951,-1031.5 6951,-995.5 6876,-995.5"/>
<text text-anchor="middle" x="6913.5" y="-1009.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_6&#45;&gt;drop_ffn_6 -->
<g id="edge54" class="edge">
<title>ffn_6&#45;&gt;drop_ffn_6</title>
<path fill="none" stroke="black" d="M6839.15,-1013.5C6848.18,-1013.5 6857.23,-1013.5 6865.73,-1013.5"/>
<polygon fill="black" stroke="black" points="6865.8,-1017 6875.8,-1013.5 6865.8,-1010 6865.8,-1017"/>
</g>
<!-- residual_out_6 -->
<g id="node51" class="node">
<title>residual_out_6</title>
<polygon fill="#f4f6f8" stroke="black" points="7029,-1009.5 7029,-1045.5 7149,-1045.5 7149,-1009.5 7029,-1009.5"/>
<text text-anchor="middle" x="7089" y="-1023.8" font-family="Times,serif" font-size="14.00">residual_out_6</text>
</g>
<!-- drop_ffn_6&#45;&gt;residual_out_6 -->
<!-- norm_attn_7 -->
<g id="node52" class="node">
<title>norm_attn_7</title>
<polygon fill="#ffffff" stroke="black" points="7043,-928.5 7043,-964.5 7135,-964.5 7135,-928.5 7043,-928.5"/>
<text text-anchor="middle" x="7089" y="-942.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_6&#45;&gt;norm_attn_7 -->
<g id="edge63" class="edge">
<title>drop_ffn_6&#45;&gt;norm_attn_7</title>
<path fill="none" stroke="black" d="M6951.29,-999.29C6975.13,-990.09 7006.59,-977.94 7033.32,-967.62"/>
<polygon fill="black" stroke="black" points="7034.86,-970.77 7042.93,-963.9 7032.34,-964.24 7034.86,-970.77"/>
<text text-anchor="middle" x="6990" y="-995.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_7 -->
<g id="node53" class="node">
<title>attn_7</title>
<polygon fill="#ffffff" stroke="black" points="7186,-888 7186,-971 7351,-971 7351,-888 7186,-888"/>
<text text-anchor="middle" x="7268.5" y="-955.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="7268.5" y="-940.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="7268.5" y="-925.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="7268.5" y="-910.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="7268.5" y="-895.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_7&#45;&gt;attn_7 -->
<g id="edge58" class="edge">
<title>norm_attn_7&#45;&gt;attn_7</title>
<path fill="none" stroke="black" d="M7135.25,-942.17C7147.65,-940.98 7161.55,-939.65 7175.56,-938.31"/>
<polygon fill="black" stroke="black" points="7176.14,-941.77 7185.76,-937.33 7175.47,-934.8 7176.14,-941.77"/>
</g>
<!-- drop_attn_7 -->
<g id="node54" class="node">
<title>drop_attn_7</title>
<polygon fill="#ffffff" stroke="black" points="7388,-911.5 7388,-947.5 7463,-947.5 7463,-911.5 7388,-911.5"/>
<text text-anchor="middle" x="7425.5" y="-925.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_7&#45;&gt;drop_attn_7 -->
<g id="edge59" class="edge">
<title>attn_7&#45;&gt;drop_attn_7</title>
<path fill="none" stroke="black" d="M7351.09,-929.5C7360.21,-929.5 7369.26,-929.5 7377.73,-929.5"/>
<polygon fill="black" stroke="black" points="7377.73,-933 7387.73,-929.5 7377.73,-926 7377.73,-933"/>
</g>
<!-- norm_ffn_7 -->
<g id="node55" class="node">
<title>norm_ffn_7</title>
<polygon fill="#ffffff" stroke="black" points="7500,-911.5 7500,-947.5 7592,-947.5 7592,-911.5 7500,-911.5"/>
<text text-anchor="middle" x="7546" y="-925.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_7&#45;&gt;norm_ffn_7 -->
<g id="edge60" class="edge">
<title>drop_attn_7&#45;&gt;norm_ffn_7</title>
<path fill="none" stroke="black" d="M7463.02,-929.5C7471.42,-929.5 7480.54,-929.5 7489.54,-929.5"/>
<polygon fill="black" stroke="black" points="7489.61,-933 7499.61,-929.5 7489.61,-926 7489.61,-933"/>
</g>
<!-- ffn_7 -->
<g id="node56" class="node">
<title>ffn_7</title>
<polygon fill="#ffffff" stroke="black" points="7629,-910.5 7629,-948.5 7774,-948.5 7774,-910.5 7629,-910.5"/>
<text text-anchor="middle" x="7701.5" y="-933.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="7701.5" y="-918.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_7&#45;&gt;ffn_7 -->
<g id="edge61" class="edge">
<title>norm_ffn_7&#45;&gt;ffn_7</title>
<path fill="none" stroke="black" d="M7592.22,-929.5C7600.58,-929.5 7609.53,-929.5 7618.59,-929.5"/>
<polygon fill="black" stroke="black" points="7618.82,-933 7628.82,-929.5 7618.82,-926 7618.82,-933"/>
</g>
<!-- drop_ffn_7 -->
<g id="node57" class="node">
<title>drop_ffn_7</title>
<polygon fill="#ffffff" stroke="black" points="7811,-911.5 7811,-947.5 7886,-947.5 7886,-911.5 7811,-911.5"/>
<text text-anchor="middle" x="7848.5" y="-925.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_7&#45;&gt;drop_ffn_7 -->
<g id="edge62" class="edge">
<title>ffn_7&#45;&gt;drop_ffn_7</title>
<path fill="none" stroke="black" d="M7774.15,-929.5C7783.18,-929.5 7792.23,-929.5 7800.73,-929.5"/>
<polygon fill="black" stroke="black" points="7800.8,-933 7810.8,-929.5 7800.8,-926 7800.8,-933"/>
</g>
<!-- residual_out_7 -->
<g id="node58" class="node">
<title>residual_out_7</title>
<polygon fill="#f4f6f8" stroke="black" points="7964,-927.5 7964,-963.5 8084,-963.5 8084,-927.5 7964,-927.5"/>
<text text-anchor="middle" x="8024" y="-941.8" font-family="Times,serif" font-size="14.00">residual_out_7</text>
</g>
<!-- drop_ffn_7&#45;&gt;residual_out_7 -->
<!-- norm_attn_8 -->
<g id="node59" class="node">
<title>norm_attn_8</title>
<polygon fill="#ffffff" stroke="black" points="7978,-846.5 7978,-882.5 8070,-882.5 8070,-846.5 7978,-846.5"/>
<text text-anchor="middle" x="8024" y="-860.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_7&#45;&gt;norm_attn_8 -->
<g id="edge71" class="edge">
<title>drop_ffn_7&#45;&gt;norm_attn_8</title>
<path fill="none" stroke="black" d="M7886.29,-915.72C7910.13,-906.79 7941.59,-895 7968.32,-884.99"/>
<polygon fill="black" stroke="black" points="7969.79,-888.17 7977.93,-881.38 7967.34,-881.62 7969.79,-888.17"/>
<text text-anchor="middle" x="7925" y="-911.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_8 -->
<g id="node60" class="node">
<title>attn_8</title>
<polygon fill="#ffffff" stroke="black" points="8121,-806 8121,-889 8286,-889 8286,-806 8121,-806"/>
<text text-anchor="middle" x="8203.5" y="-873.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="8203.5" y="-858.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="8203.5" y="-843.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="8203.5" y="-828.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="8203.5" y="-813.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_8&#45;&gt;attn_8 -->
<g id="edge66" class="edge">
<title>norm_attn_8&#45;&gt;attn_8</title>
<path fill="none" stroke="black" d="M8070.25,-860.17C8082.65,-858.98 8096.55,-857.65 8110.56,-856.31"/>
<polygon fill="black" stroke="black" points="8111.14,-859.77 8120.76,-855.33 8110.47,-852.8 8111.14,-859.77"/>
</g>
<!-- drop_attn_8 -->
<g id="node61" class="node">
<title>drop_attn_8</title>
<polygon fill="#ffffff" stroke="black" points="8323,-829.5 8323,-865.5 8398,-865.5 8398,-829.5 8323,-829.5"/>
<text text-anchor="middle" x="8360.5" y="-843.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_8&#45;&gt;drop_attn_8 -->
<g id="edge67" class="edge">
<title>attn_8&#45;&gt;drop_attn_8</title>
<path fill="none" stroke="black" d="M8286.09,-847.5C8295.21,-847.5 8304.26,-847.5 8312.73,-847.5"/>
<polygon fill="black" stroke="black" points="8312.73,-851 8322.73,-847.5 8312.73,-844 8312.73,-851"/>
</g>
<!-- norm_ffn_8 -->
<g id="node62" class="node">
<title>norm_ffn_8</title>
<polygon fill="#ffffff" stroke="black" points="8435,-829.5 8435,-865.5 8527,-865.5 8527,-829.5 8435,-829.5"/>
<text text-anchor="middle" x="8481" y="-843.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_8&#45;&gt;norm_ffn_8 -->
<g id="edge68" class="edge">
<title>drop_attn_8&#45;&gt;norm_ffn_8</title>
<path fill="none" stroke="black" d="M8398.02,-847.5C8406.42,-847.5 8415.54,-847.5 8424.54,-847.5"/>
<polygon fill="black" stroke="black" points="8424.61,-851 8434.61,-847.5 8424.61,-844 8424.61,-851"/>
</g>
<!-- ffn_8 -->
<g id="node63" class="node">
<title>ffn_8</title>
<polygon fill="#ffffff" stroke="black" points="8564,-828.5 8564,-866.5 8709,-866.5 8709,-828.5 8564,-828.5"/>
<text text-anchor="middle" x="8636.5" y="-851.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="8636.5" y="-836.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_8&#45;&gt;ffn_8 -->
<g id="edge69" class="edge">
<title>norm_ffn_8&#45;&gt;ffn_8</title>
<path fill="none" stroke="black" d="M8527.22,-847.5C8535.58,-847.5 8544.53,-847.5 8553.59,-847.5"/>
<polygon fill="black" stroke="black" points="8553.82,-851 8563.82,-847.5 8553.82,-844 8553.82,-851"/>
</g>
<!-- drop_ffn_8 -->
<g id="node64" class="node">
<title>drop_ffn_8</title>
<polygon fill="#ffffff" stroke="black" points="8746,-829.5 8746,-865.5 8821,-865.5 8821,-829.5 8746,-829.5"/>
<text text-anchor="middle" x="8783.5" y="-843.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_8&#45;&gt;drop_ffn_8 -->
<g id="edge70" class="edge">
<title>ffn_8&#45;&gt;drop_ffn_8</title>
<path fill="none" stroke="black" d="M8709.15,-847.5C8718.18,-847.5 8727.23,-847.5 8735.73,-847.5"/>
<polygon fill="black" stroke="black" points="8735.8,-851 8745.8,-847.5 8735.8,-844 8735.8,-851"/>
</g>
<!-- residual_out_8 -->
<g id="node65" class="node">
<title>residual_out_8</title>
<polygon fill="#f4f6f8" stroke="black" points="8899,-851.5 8899,-887.5 9019,-887.5 9019,-851.5 8899,-851.5"/>
<text text-anchor="middle" x="8959" y="-865.8" font-family="Times,serif" font-size="14.00">residual_out_8</text>
</g>
<!-- drop_ffn_8&#45;&gt;residual_out_8 -->
<!-- norm_attn_9 -->
<g id="node66" class="node">
<title>norm_attn_9</title>
<polygon fill="#ffffff" stroke="black" points="8913,-765.5 8913,-801.5 9005,-801.5 9005,-765.5 8913,-765.5"/>
<text text-anchor="middle" x="8959" y="-779.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_8&#45;&gt;norm_attn_9 -->
<g id="edge79" class="edge">
<title>drop_ffn_8&#45;&gt;norm_attn_9</title>
<path fill="none" stroke="black" d="M8821.29,-833.93C8845.13,-825.14 8876.59,-813.53 8903.32,-803.67"/>
<polygon fill="black" stroke="black" points="8904.76,-806.87 8912.93,-800.12 8902.34,-800.3 8904.76,-806.87"/>
<text text-anchor="middle" x="8860" y="-830.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_9 -->
<g id="node67" class="node">
<title>attn_9</title>
<polygon fill="#ffffff" stroke="black" points="9056,-730 9056,-813 9221,-813 9221,-730 9056,-730"/>
<text text-anchor="middle" x="9138.5" y="-797.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="9138.5" y="-782.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="9138.5" y="-767.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="9138.5" y="-752.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="9138.5" y="-737.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_9&#45;&gt;attn_9 -->
<g id="edge74" class="edge">
<title>norm_attn_9&#45;&gt;attn_9</title>
<path fill="none" stroke="black" d="M9005.25,-780.44C9017.65,-779.6 9031.55,-778.66 9045.56,-777.72"/>
<polygon fill="black" stroke="black" points="9046.02,-781.19 9055.76,-777.03 9045.54,-774.21 9046.02,-781.19"/>
</g>
<!-- drop_attn_9 -->
<g id="node68" class="node">
<title>drop_attn_9</title>
<polygon fill="#ffffff" stroke="black" points="9258,-753.5 9258,-789.5 9333,-789.5 9333,-753.5 9258,-753.5"/>
<text text-anchor="middle" x="9295.5" y="-767.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_9&#45;&gt;drop_attn_9 -->
<g id="edge75" class="edge">
<title>attn_9&#45;&gt;drop_attn_9</title>
<path fill="none" stroke="black" d="M9221.09,-771.5C9230.21,-771.5 9239.26,-771.5 9247.73,-771.5"/>
<polygon fill="black" stroke="black" points="9247.73,-775 9257.73,-771.5 9247.73,-768 9247.73,-775"/>
</g>
<!-- norm_ffn_9 -->
<g id="node69" class="node">
<title>norm_ffn_9</title>
<polygon fill="#ffffff" stroke="black" points="9370,-753.5 9370,-789.5 9462,-789.5 9462,-753.5 9370,-753.5"/>
<text text-anchor="middle" x="9416" y="-767.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_9&#45;&gt;norm_ffn_9 -->
<g id="edge76" class="edge">
<title>drop_attn_9&#45;&gt;norm_ffn_9</title>
<path fill="none" stroke="black" d="M9333.02,-771.5C9341.42,-771.5 9350.54,-771.5 9359.54,-771.5"/>
<polygon fill="black" stroke="black" points="9359.61,-775 9369.61,-771.5 9359.61,-768 9359.61,-775"/>
</g>
<!-- ffn_9 -->
<g id="node70" class="node">
<title>ffn_9</title>
<polygon fill="#ffffff" stroke="black" points="9499,-752.5 9499,-790.5 9644,-790.5 9644,-752.5 9499,-752.5"/>
<text text-anchor="middle" x="9571.5" y="-775.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="9571.5" y="-760.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_9&#45;&gt;ffn_9 -->
<g id="edge77" class="edge">
<title>norm_ffn_9&#45;&gt;ffn_9</title>
<path fill="none" stroke="black" d="M9462.22,-771.5C9470.58,-771.5 9479.53,-771.5 9488.59,-771.5"/>
<polygon fill="black" stroke="black" points="9488.82,-775 9498.82,-771.5 9488.82,-768 9488.82,-775"/>
</g>
<!-- drop_ffn_9 -->
<g id="node71" class="node">
<title>drop_ffn_9</title>
<polygon fill="#ffffff" stroke="black" points="9681,-753.5 9681,-789.5 9756,-789.5 9756,-753.5 9681,-753.5"/>
<text text-anchor="middle" x="9718.5" y="-767.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_9&#45;&gt;drop_ffn_9 -->
<g id="edge78" class="edge">
<title>ffn_9&#45;&gt;drop_ffn_9</title>
<path fill="none" stroke="black" d="M9644.15,-771.5C9653.18,-771.5 9662.23,-771.5 9670.73,-771.5"/>
<polygon fill="black" stroke="black" points="9670.8,-775 9680.8,-771.5 9670.8,-768 9670.8,-775"/>
</g>
<!-- residual_out_9 -->
<g id="node72" class="node">
<title>residual_out_9</title>
<polygon fill="#f4f6f8" stroke="black" points="9834,-772.5 9834,-808.5 9954,-808.5 9954,-772.5 9834,-772.5"/>
<text text-anchor="middle" x="9894" y="-786.8" font-family="Times,serif" font-size="14.00">residual_out_9</text>
</g>
<!-- drop_ffn_9&#45;&gt;residual_out_9 -->
<!-- norm_attn_10 -->
<g id="node73" class="node">
<title>norm_attn_10</title>
<polygon fill="#ffffff" stroke="black" points="9848,-691.5 9848,-727.5 9940,-727.5 9940,-691.5 9848,-691.5"/>
<text text-anchor="middle" x="9894" y="-705.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_9&#45;&gt;norm_attn_10 -->
<g id="edge87" class="edge">
<title>drop_ffn_9&#45;&gt;norm_attn_10</title>
<path fill="none" stroke="black" d="M9756.29,-758.35C9780.13,-749.84 9811.59,-738.59 9838.32,-729.04"/>
<polygon fill="black" stroke="black" points="9839.69,-732.27 9847.93,-725.61 9837.34,-725.67 9839.69,-732.27"/>
<text text-anchor="middle" x="9795" y="-754.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_10 -->
<g id="node74" class="node">
<title>attn_10</title>
<polygon fill="#ffffff" stroke="black" points="9991,-651 9991,-734 10156,-734 10156,-651 9991,-651"/>
<text text-anchor="middle" x="10073.5" y="-718.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="10073.5" y="-703.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="10073.5" y="-688.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="10073.5" y="-673.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="10073.5" y="-658.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_10&#45;&gt;attn_10 -->
<g id="edge82" class="edge">
<title>norm_attn_10&#45;&gt;attn_10</title>
<path fill="none" stroke="black" d="M9940.25,-705.17C9952.65,-703.98 9966.55,-702.65 9980.56,-701.31"/>
<polygon fill="black" stroke="black" points="9981.14,-704.77 9990.76,-700.33 9980.47,-697.8 9981.14,-704.77"/>
</g>
<!-- drop_attn_10 -->
<g id="node75" class="node">
<title>drop_attn_10</title>
<polygon fill="#ffffff" stroke="black" points="10193,-674.5 10193,-710.5 10268,-710.5 10268,-674.5 10193,-674.5"/>
<text text-anchor="middle" x="10230.5" y="-688.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_10&#45;&gt;drop_attn_10 -->
<g id="edge83" class="edge">
<title>attn_10&#45;&gt;drop_attn_10</title>
<path fill="none" stroke="black" d="M10156.09,-692.5C10165.21,-692.5 10174.26,-692.5 10182.73,-692.5"/>
<polygon fill="black" stroke="black" points="10182.73,-696 10192.73,-692.5 10182.73,-689 10182.73,-696"/>
</g>
<!-- norm_ffn_10 -->
<g id="node76" class="node">
<title>norm_ffn_10</title>
<polygon fill="#ffffff" stroke="black" points="10305,-674.5 10305,-710.5 10397,-710.5 10397,-674.5 10305,-674.5"/>
<text text-anchor="middle" x="10351" y="-688.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_10&#45;&gt;norm_ffn_10 -->
<g id="edge84" class="edge">
<title>drop_attn_10&#45;&gt;norm_ffn_10</title>
<path fill="none" stroke="black" d="M10268.02,-692.5C10276.42,-692.5 10285.54,-692.5 10294.54,-692.5"/>
<polygon fill="black" stroke="black" points="10294.61,-696 10304.61,-692.5 10294.61,-689 10294.61,-696"/>
</g>
<!-- ffn_10 -->
<g id="node77" class="node">
<title>ffn_10</title>
<polygon fill="#ffffff" stroke="black" points="10434,-673.5 10434,-711.5 10579,-711.5 10579,-673.5 10434,-673.5"/>
<text text-anchor="middle" x="10506.5" y="-696.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="10506.5" y="-681.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_10&#45;&gt;ffn_10 -->
<g id="edge85" class="edge">
<title>norm_ffn_10&#45;&gt;ffn_10</title>
<path fill="none" stroke="black" d="M10397.22,-692.5C10405.58,-692.5 10414.53,-692.5 10423.59,-692.5"/>
<polygon fill="black" stroke="black" points="10423.82,-696 10433.82,-692.5 10423.82,-689 10423.82,-696"/>
</g>
<!-- drop_ffn_10 -->
<g id="node78" class="node">
<title>drop_ffn_10</title>
<polygon fill="#ffffff" stroke="black" points="10616,-674.5 10616,-710.5 10691,-710.5 10691,-674.5 10616,-674.5"/>
<text text-anchor="middle" x="10653.5" y="-688.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_10&#45;&gt;drop_ffn_10 -->
<g id="edge86" class="edge">
<title>ffn_10&#45;&gt;drop_ffn_10</title>
<path fill="none" stroke="black" d="M10579.15,-692.5C10588.18,-692.5 10597.23,-692.5 10605.73,-692.5"/>
<polygon fill="black" stroke="black" points="10605.8,-696 10615.8,-692.5 10605.8,-689 10605.8,-696"/>
</g>
<!-- residual_out_10 -->
<g id="node79" class="node">
<title>residual_out_10</title>
<polygon fill="#f4f6f8" stroke="black" points="10769,-690.5 10769,-726.5 10898,-726.5 10898,-690.5 10769,-690.5"/>
<text text-anchor="middle" x="10833.5" y="-704.8" font-family="Times,serif" font-size="14.00">residual_out_10</text>
</g>
<!-- drop_ffn_10&#45;&gt;residual_out_10 -->
<!-- norm_attn_11 -->
<g id="node80" class="node">
<title>norm_attn_11</title>
<polygon fill="#ffffff" stroke="black" points="10787.5,-609.5 10787.5,-645.5 10879.5,-645.5 10879.5,-609.5 10787.5,-609.5"/>
<text text-anchor="middle" x="10833.5" y="-623.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_10&#45;&gt;norm_attn_11 -->
<g id="edge95" class="edge">
<title>drop_ffn_10&#45;&gt;norm_attn_11</title>
<path fill="none" stroke="black" d="M10691.38,-679.03C10716.34,-669.92 10749.74,-657.72 10777.78,-647.48"/>
<polygon fill="black" stroke="black" points="10779.26,-650.67 10787.46,-643.95 10776.86,-644.09 10779.26,-650.67"/>
<text text-anchor="middle" x="10730" y="-674.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_11 -->
<g id="node81" class="node">
<title>attn_11</title>
<polygon fill="#ffffff" stroke="black" points="10935,-569 10935,-652 11100,-652 11100,-569 10935,-569"/>
<text text-anchor="middle" x="11017.5" y="-636.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="11017.5" y="-621.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="11017.5" y="-606.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="11017.5" y="-591.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="11017.5" y="-576.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_11&#45;&gt;attn_11 -->
<g id="edge90" class="edge">
<title>norm_attn_11&#45;&gt;attn_11</title>
<path fill="none" stroke="black" d="M10879.96,-623.25C10893.6,-621.98 10909.09,-620.53 10924.61,-619.08"/>
<polygon fill="black" stroke="black" points="10925.17,-622.55 10934.8,-618.13 10924.52,-615.58 10925.17,-622.55"/>
</g>
<!-- drop_attn_11 -->
<g id="node82" class="node">
<title>drop_attn_11</title>
<polygon fill="#ffffff" stroke="black" points="11137,-592.5 11137,-628.5 11212,-628.5 11212,-592.5 11137,-592.5"/>
<text text-anchor="middle" x="11174.5" y="-606.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_11&#45;&gt;drop_attn_11 -->
<g id="edge91" class="edge">
<title>attn_11&#45;&gt;drop_attn_11</title>
<path fill="none" stroke="black" d="M11100.09,-610.5C11109.21,-610.5 11118.26,-610.5 11126.73,-610.5"/>
<polygon fill="black" stroke="black" points="11126.73,-614 11136.73,-610.5 11126.73,-607 11126.73,-614"/>
</g>
<!-- norm_ffn_11 -->
<g id="node83" class="node">
<title>norm_ffn_11</title>
<polygon fill="#ffffff" stroke="black" points="11249,-592.5 11249,-628.5 11341,-628.5 11341,-592.5 11249,-592.5"/>
<text text-anchor="middle" x="11295" y="-606.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_11&#45;&gt;norm_ffn_11 -->
<g id="edge92" class="edge">
<title>drop_attn_11&#45;&gt;norm_ffn_11</title>
<path fill="none" stroke="black" d="M11212.02,-610.5C11220.42,-610.5 11229.54,-610.5 11238.54,-610.5"/>
<polygon fill="black" stroke="black" points="11238.61,-614 11248.61,-610.5 11238.61,-607 11238.61,-614"/>
</g>
<!-- ffn_11 -->
<g id="node84" class="node">
<title>ffn_11</title>
<polygon fill="#ffffff" stroke="black" points="11378,-591.5 11378,-629.5 11523,-629.5 11523,-591.5 11378,-591.5"/>
<text text-anchor="middle" x="11450.5" y="-614.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="11450.5" y="-599.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_11&#45;&gt;ffn_11 -->
<g id="edge93" class="edge">
<title>norm_ffn_11&#45;&gt;ffn_11</title>
<path fill="none" stroke="black" d="M11341.22,-610.5C11349.58,-610.5 11358.53,-610.5 11367.59,-610.5"/>
<polygon fill="black" stroke="black" points="11367.82,-614 11377.82,-610.5 11367.82,-607 11367.82,-614"/>
</g>
<!-- drop_ffn_11 -->
<g id="node85" class="node">
<title>drop_ffn_11</title>
<polygon fill="#ffffff" stroke="black" points="11560,-592.5 11560,-628.5 11635,-628.5 11635,-592.5 11560,-592.5"/>
<text text-anchor="middle" x="11597.5" y="-606.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_11&#45;&gt;drop_ffn_11 -->
<g id="edge94" class="edge">
<title>ffn_11&#45;&gt;drop_ffn_11</title>
<path fill="none" stroke="black" d="M11523.15,-610.5C11532.18,-610.5 11541.23,-610.5 11549.73,-610.5"/>
<polygon fill="black" stroke="black" points="11549.8,-614 11559.8,-610.5 11549.8,-607 11549.8,-614"/>
</g>
<!-- residual_out_11 -->
<g id="node86" class="node">
<title>residual_out_11</title>
<polygon fill="#f4f6f8" stroke="black" points="11713,-605.5 11713,-641.5 11842,-641.5 11842,-605.5 11713,-605.5"/>
<text text-anchor="middle" x="11777.5" y="-619.8" font-family="Times,serif" font-size="14.00">residual_out_11</text>
</g>
<!-- drop_ffn_11&#45;&gt;residual_out_11 -->
<!-- norm_attn_12 -->
<g id="node87" class="node">
<title>norm_attn_12</title>
<polygon fill="#ffffff" stroke="black" points="11731.5,-524.5 11731.5,-560.5 11823.5,-560.5 11823.5,-524.5 11731.5,-524.5"/>
<text text-anchor="middle" x="11777.5" y="-538.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_11&#45;&gt;norm_attn_12 -->
<g id="edge103" class="edge">
<title>drop_ffn_11&#45;&gt;norm_attn_12</title>
<path fill="none" stroke="black" d="M11635.38,-596.41C11660.34,-586.88 11693.74,-574.12 11721.78,-563.4"/>
<polygon fill="black" stroke="black" points="11723.36,-566.55 11731.46,-559.71 11720.87,-560.01 11723.36,-566.55"/>
<text text-anchor="middle" x="11674" y="-592.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_12 -->
<g id="node88" class="node">
<title>attn_12</title>
<polygon fill="#ffffff" stroke="black" points="11879,-484 11879,-567 12044,-567 12044,-484 11879,-484"/>
<text text-anchor="middle" x="11961.5" y="-551.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="11961.5" y="-536.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="11961.5" y="-521.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="11961.5" y="-506.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="11961.5" y="-491.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_12&#45;&gt;attn_12 -->
<g id="edge98" class="edge">
<title>norm_attn_12&#45;&gt;attn_12</title>
<path fill="none" stroke="black" d="M11823.96,-538.25C11837.6,-536.98 11853.09,-535.53 11868.61,-534.08"/>
<polygon fill="black" stroke="black" points="11869.17,-537.55 11878.8,-533.13 11868.52,-530.58 11869.17,-537.55"/>
</g>
<!-- drop_attn_12 -->
<g id="node89" class="node">
<title>drop_attn_12</title>
<polygon fill="#ffffff" stroke="black" points="12081,-507.5 12081,-543.5 12156,-543.5 12156,-507.5 12081,-507.5"/>
<text text-anchor="middle" x="12118.5" y="-521.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_12&#45;&gt;drop_attn_12 -->
<g id="edge99" class="edge">
<title>attn_12&#45;&gt;drop_attn_12</title>
<path fill="none" stroke="black" d="M12044.09,-525.5C12053.21,-525.5 12062.26,-525.5 12070.73,-525.5"/>
<polygon fill="black" stroke="black" points="12070.73,-529 12080.73,-525.5 12070.73,-522 12070.73,-529"/>
</g>
<!-- norm_ffn_12 -->
<g id="node90" class="node">
<title>norm_ffn_12</title>
<polygon fill="#ffffff" stroke="black" points="12193,-507.5 12193,-543.5 12285,-543.5 12285,-507.5 12193,-507.5"/>
<text text-anchor="middle" x="12239" y="-521.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_12&#45;&gt;norm_ffn_12 -->
<g id="edge100" class="edge">
<title>drop_attn_12&#45;&gt;norm_ffn_12</title>
<path fill="none" stroke="black" d="M12156.02,-525.5C12164.42,-525.5 12173.54,-525.5 12182.54,-525.5"/>
<polygon fill="black" stroke="black" points="12182.61,-529 12192.61,-525.5 12182.61,-522 12182.61,-529"/>
</g>
<!-- ffn_12 -->
<g id="node91" class="node">
<title>ffn_12</title>
<polygon fill="#ffffff" stroke="black" points="12322,-506.5 12322,-544.5 12467,-544.5 12467,-506.5 12322,-506.5"/>
<text text-anchor="middle" x="12394.5" y="-529.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="12394.5" y="-514.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_12&#45;&gt;ffn_12 -->
<g id="edge101" class="edge">
<title>norm_ffn_12&#45;&gt;ffn_12</title>
<path fill="none" stroke="black" d="M12285.22,-525.5C12293.58,-525.5 12302.53,-525.5 12311.59,-525.5"/>
<polygon fill="black" stroke="black" points="12311.82,-529 12321.82,-525.5 12311.82,-522 12311.82,-529"/>
</g>
<!-- drop_ffn_12 -->
<g id="node92" class="node">
<title>drop_ffn_12</title>
<polygon fill="#ffffff" stroke="black" points="12504,-507.5 12504,-543.5 12579,-543.5 12579,-507.5 12504,-507.5"/>
<text text-anchor="middle" x="12541.5" y="-521.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_12&#45;&gt;drop_ffn_12 -->
<g id="edge102" class="edge">
<title>ffn_12&#45;&gt;drop_ffn_12</title>
<path fill="none" stroke="black" d="M12467.15,-525.5C12476.18,-525.5 12485.23,-525.5 12493.73,-525.5"/>
<polygon fill="black" stroke="black" points="12493.8,-529 12503.8,-525.5 12493.8,-522 12493.8,-529"/>
</g>
<!-- residual_out_12 -->
<g id="node93" class="node">
<title>residual_out_12</title>
<polygon fill="#f4f6f8" stroke="black" points="12657,-526.5 12657,-562.5 12786,-562.5 12786,-526.5 12657,-526.5"/>
<text text-anchor="middle" x="12721.5" y="-540.8" font-family="Times,serif" font-size="14.00">residual_out_12</text>
</g>
<!-- drop_ffn_12&#45;&gt;residual_out_12 -->
<!-- norm_attn_13 -->
<g id="node94" class="node">
<title>norm_attn_13</title>
<polygon fill="#ffffff" stroke="black" points="12675.5,-445.5 12675.5,-481.5 12767.5,-481.5 12767.5,-445.5 12675.5,-445.5"/>
<text text-anchor="middle" x="12721.5" y="-459.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_12&#45;&gt;norm_attn_13 -->
<g id="edge111" class="edge">
<title>drop_ffn_12&#45;&gt;norm_attn_13</title>
<path fill="none" stroke="black" d="M12579.38,-512.65C12604.34,-503.96 12637.74,-492.33 12665.78,-482.56"/>
<polygon fill="black" stroke="black" points="12667.17,-485.78 12675.46,-479.19 12664.86,-479.17 12667.17,-485.78"/>
<text text-anchor="middle" x="12618" y="-508.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_13 -->
<g id="node95" class="node">
<title>attn_13</title>
<polygon fill="#ffffff" stroke="black" points="12823,-405 12823,-488 12988,-488 12988,-405 12823,-405"/>
<text text-anchor="middle" x="12905.5" y="-472.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="12905.5" y="-457.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="12905.5" y="-442.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="12905.5" y="-427.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="12905.5" y="-412.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_13&#45;&gt;attn_13 -->
<g id="edge106" class="edge">
<title>norm_attn_13&#45;&gt;attn_13</title>
<path fill="none" stroke="black" d="M12767.96,-459.25C12781.6,-457.98 12797.09,-456.53 12812.61,-455.08"/>
<polygon fill="black" stroke="black" points="12813.17,-458.55 12822.8,-454.13 12812.52,-451.58 12813.17,-458.55"/>
</g>
<!-- drop_attn_13 -->
<g id="node96" class="node">
<title>drop_attn_13</title>
<polygon fill="#ffffff" stroke="black" points="13025,-428.5 13025,-464.5 13100,-464.5 13100,-428.5 13025,-428.5"/>
<text text-anchor="middle" x="13062.5" y="-442.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_13&#45;&gt;drop_attn_13 -->
<g id="edge107" class="edge">
<title>attn_13&#45;&gt;drop_attn_13</title>
<path fill="none" stroke="black" d="M12988.09,-446.5C12997.21,-446.5 13006.26,-446.5 13014.73,-446.5"/>
<polygon fill="black" stroke="black" points="13014.73,-450 13024.73,-446.5 13014.73,-443 13014.73,-450"/>
</g>
<!-- norm_ffn_13 -->
<g id="node97" class="node">
<title>norm_ffn_13</title>
<polygon fill="#ffffff" stroke="black" points="13137,-428.5 13137,-464.5 13229,-464.5 13229,-428.5 13137,-428.5"/>
<text text-anchor="middle" x="13183" y="-442.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_13&#45;&gt;norm_ffn_13 -->
<g id="edge108" class="edge">
<title>drop_attn_13&#45;&gt;norm_ffn_13</title>
<path fill="none" stroke="black" d="M13100.02,-446.5C13108.42,-446.5 13117.54,-446.5 13126.54,-446.5"/>
<polygon fill="black" stroke="black" points="13126.61,-450 13136.61,-446.5 13126.61,-443 13126.61,-450"/>
</g>
<!-- ffn_13 -->
<g id="node98" class="node">
<title>ffn_13</title>
<polygon fill="#ffffff" stroke="black" points="13266,-427.5 13266,-465.5 13411,-465.5 13411,-427.5 13266,-427.5"/>
<text text-anchor="middle" x="13338.5" y="-450.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="13338.5" y="-435.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_13&#45;&gt;ffn_13 -->
<g id="edge109" class="edge">
<title>norm_ffn_13&#45;&gt;ffn_13</title>
<path fill="none" stroke="black" d="M13229.22,-446.5C13237.58,-446.5 13246.53,-446.5 13255.59,-446.5"/>
<polygon fill="black" stroke="black" points="13255.82,-450 13265.82,-446.5 13255.82,-443 13255.82,-450"/>
</g>
<!-- drop_ffn_13 -->
<g id="node99" class="node">
<title>drop_ffn_13</title>
<polygon fill="#ffffff" stroke="black" points="13448,-428.5 13448,-464.5 13523,-464.5 13523,-428.5 13448,-428.5"/>
<text text-anchor="middle" x="13485.5" y="-442.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_13&#45;&gt;drop_ffn_13 -->
<g id="edge110" class="edge">
<title>ffn_13&#45;&gt;drop_ffn_13</title>
<path fill="none" stroke="black" d="M13411.15,-446.5C13420.18,-446.5 13429.23,-446.5 13437.73,-446.5"/>
<polygon fill="black" stroke="black" points="13437.8,-450 13447.8,-446.5 13437.8,-443 13437.8,-450"/>
</g>
<!-- residual_out_13 -->
<g id="node100" class="node">
<title>residual_out_13</title>
<polygon fill="#f4f6f8" stroke="black" points="13601,-465.5 13601,-501.5 13730,-501.5 13730,-465.5 13601,-465.5"/>
<text text-anchor="middle" x="13665.5" y="-479.8" font-family="Times,serif" font-size="14.00">residual_out_13</text>
</g>
<!-- drop_ffn_13&#45;&gt;residual_out_13 -->
<!-- norm_attn_14 -->
<g id="node101" class="node">
<title>norm_attn_14</title>
<polygon fill="#ffffff" stroke="black" points="13619.5,-384.5 13619.5,-420.5 13711.5,-420.5 13711.5,-384.5 13619.5,-384.5"/>
<text text-anchor="middle" x="13665.5" y="-398.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_13&#45;&gt;norm_attn_14 -->
<g id="edge119" class="edge">
<title>drop_ffn_13&#45;&gt;norm_attn_14</title>
<path fill="none" stroke="black" d="M13523.38,-437.38C13548.23,-431.24 13581.45,-423.03 13609.42,-416.12"/>
<polygon fill="black" stroke="black" points="13610.59,-419.43 13619.46,-413.63 13608.91,-412.64 13610.59,-419.43"/>
<text text-anchor="middle" x="13562" y="-435.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_14 -->
<g id="node102" class="node">
<title>attn_14</title>
<polygon fill="#ffffff" stroke="black" points="13767,-344 13767,-427 13932,-427 13932,-344 13767,-344"/>
<text text-anchor="middle" x="13849.5" y="-411.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="13849.5" y="-396.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="13849.5" y="-381.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="13849.5" y="-366.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="13849.5" y="-351.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_14&#45;&gt;attn_14 -->
<g id="edge114" class="edge">
<title>norm_attn_14&#45;&gt;attn_14</title>
<path fill="none" stroke="black" d="M13711.96,-398.25C13725.6,-396.98 13741.09,-395.53 13756.61,-394.08"/>
<polygon fill="black" stroke="black" points="13757.17,-397.55 13766.8,-393.13 13756.52,-390.58 13757.17,-397.55"/>
</g>
<!-- drop_attn_14 -->
<g id="node103" class="node">
<title>drop_attn_14</title>
<polygon fill="#ffffff" stroke="black" points="13969,-367.5 13969,-403.5 14044,-403.5 14044,-367.5 13969,-367.5"/>
<text text-anchor="middle" x="14006.5" y="-381.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_14&#45;&gt;drop_attn_14 -->
<g id="edge115" class="edge">
<title>attn_14&#45;&gt;drop_attn_14</title>
<path fill="none" stroke="black" d="M13932.09,-385.5C13941.21,-385.5 13950.26,-385.5 13958.73,-385.5"/>
<polygon fill="black" stroke="black" points="13958.73,-389 13968.73,-385.5 13958.73,-382 13958.73,-389"/>
</g>
<!-- norm_ffn_14 -->
<g id="node104" class="node">
<title>norm_ffn_14</title>
<polygon fill="#ffffff" stroke="black" points="14081,-367.5 14081,-403.5 14173,-403.5 14173,-367.5 14081,-367.5"/>
<text text-anchor="middle" x="14127" y="-381.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_14&#45;&gt;norm_ffn_14 -->
<g id="edge116" class="edge">
<title>drop_attn_14&#45;&gt;norm_ffn_14</title>
<path fill="none" stroke="black" d="M14044.02,-385.5C14052.42,-385.5 14061.54,-385.5 14070.54,-385.5"/>
<polygon fill="black" stroke="black" points="14070.61,-389 14080.61,-385.5 14070.61,-382 14070.61,-389"/>
</g>
<!-- ffn_14 -->
<g id="node105" class="node">
<title>ffn_14</title>
<polygon fill="#ffffff" stroke="black" points="14210,-366.5 14210,-404.5 14355,-404.5 14355,-366.5 14210,-366.5"/>
<text text-anchor="middle" x="14282.5" y="-389.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="14282.5" y="-374.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_14&#45;&gt;ffn_14 -->
<g id="edge117" class="edge">
<title>norm_ffn_14&#45;&gt;ffn_14</title>
<path fill="none" stroke="black" d="M14173.22,-385.5C14181.58,-385.5 14190.53,-385.5 14199.59,-385.5"/>
<polygon fill="black" stroke="black" points="14199.82,-389 14209.82,-385.5 14199.82,-382 14199.82,-389"/>
</g>
<!-- drop_ffn_14 -->
<g id="node106" class="node">
<title>drop_ffn_14</title>
<polygon fill="#ffffff" stroke="black" points="14392,-367.5 14392,-403.5 14467,-403.5 14467,-367.5 14392,-367.5"/>
<text text-anchor="middle" x="14429.5" y="-381.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_14&#45;&gt;drop_ffn_14 -->
<g id="edge118" class="edge">
<title>ffn_14&#45;&gt;drop_ffn_14</title>
<path fill="none" stroke="black" d="M14355.15,-385.5C14364.18,-385.5 14373.23,-385.5 14381.73,-385.5"/>
<polygon fill="black" stroke="black" points="14381.8,-389 14391.8,-385.5 14381.8,-382 14381.8,-389"/>
</g>
<!-- residual_out_14 -->
<g id="node107" class="node">
<title>residual_out_14</title>
<polygon fill="#f4f6f8" stroke="black" points="14545,-380.5 14545,-416.5 14674,-416.5 14674,-380.5 14545,-380.5"/>
<text text-anchor="middle" x="14609.5" y="-394.8" font-family="Times,serif" font-size="14.00">residual_out_14</text>
</g>
<!-- drop_ffn_14&#45;&gt;residual_out_14 -->
<!-- norm_attn_15 -->
<g id="node108" class="node">
<title>norm_attn_15</title>
<polygon fill="#ffffff" stroke="black" points="14563.5,-299.5 14563.5,-335.5 14655.5,-335.5 14655.5,-299.5 14563.5,-299.5"/>
<text text-anchor="middle" x="14609.5" y="-313.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_14&#45;&gt;norm_attn_15 -->
<g id="edge127" class="edge">
<title>drop_ffn_14&#45;&gt;norm_attn_15</title>
<path fill="none" stroke="black" d="M14467.38,-371.41C14492.34,-361.88 14525.74,-349.12 14553.78,-338.4"/>
<polygon fill="black" stroke="black" points="14555.36,-341.55 14563.46,-334.71 14552.87,-335.01 14555.36,-341.55"/>
<text text-anchor="middle" x="14506" y="-367.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_15 -->
<g id="node109" class="node">
<title>attn_15</title>
<polygon fill="#ffffff" stroke="black" points="14711,-259 14711,-342 14876,-342 14876,-259 14711,-259"/>
<text text-anchor="middle" x="14793.5" y="-326.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="14793.5" y="-311.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="14793.5" y="-296.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="14793.5" y="-281.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="14793.5" y="-266.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_15&#45;&gt;attn_15 -->
<g id="edge122" class="edge">
<title>norm_attn_15&#45;&gt;attn_15</title>
<path fill="none" stroke="black" d="M14655.96,-313.25C14669.6,-311.98 14685.09,-310.53 14700.61,-309.08"/>
<polygon fill="black" stroke="black" points="14701.17,-312.55 14710.8,-308.13 14700.52,-305.58 14701.17,-312.55"/>
</g>
<!-- drop_attn_15 -->
<g id="node110" class="node">
<title>drop_attn_15</title>
<polygon fill="#ffffff" stroke="black" points="14913,-282.5 14913,-318.5 14988,-318.5 14988,-282.5 14913,-282.5"/>
<text text-anchor="middle" x="14950.5" y="-296.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_15&#45;&gt;drop_attn_15 -->
<g id="edge123" class="edge">
<title>attn_15&#45;&gt;drop_attn_15</title>
<path fill="none" stroke="black" d="M14876.09,-300.5C14885.21,-300.5 14894.26,-300.5 14902.73,-300.5"/>
<polygon fill="black" stroke="black" points="14902.73,-304 14912.73,-300.5 14902.73,-297 14902.73,-304"/>
</g>
<!-- norm_ffn_15 -->
<g id="node111" class="node">
<title>norm_ffn_15</title>
<polygon fill="#ffffff" stroke="black" points="15025,-282.5 15025,-318.5 15117,-318.5 15117,-282.5 15025,-282.5"/>
<text text-anchor="middle" x="15071" y="-296.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_15&#45;&gt;norm_ffn_15 -->
<g id="edge124" class="edge">
<title>drop_attn_15&#45;&gt;norm_ffn_15</title>
<path fill="none" stroke="black" d="M14988.02,-300.5C14996.42,-300.5 15005.54,-300.5 15014.54,-300.5"/>
<polygon fill="black" stroke="black" points="15014.61,-304 15024.61,-300.5 15014.61,-297 15014.61,-304"/>
</g>
<!-- ffn_15 -->
<g id="node112" class="node">
<title>ffn_15</title>
<polygon fill="#ffffff" stroke="black" points="15154,-281.5 15154,-319.5 15299,-319.5 15299,-281.5 15154,-281.5"/>
<text text-anchor="middle" x="15226.5" y="-304.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="15226.5" y="-289.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_15&#45;&gt;ffn_15 -->
<g id="edge125" class="edge">
<title>norm_ffn_15&#45;&gt;ffn_15</title>
<path fill="none" stroke="black" d="M15117.22,-300.5C15125.58,-300.5 15134.53,-300.5 15143.59,-300.5"/>
<polygon fill="black" stroke="black" points="15143.82,-304 15153.82,-300.5 15143.82,-297 15143.82,-304"/>
</g>
<!-- drop_ffn_15 -->
<g id="node113" class="node">
<title>drop_ffn_15</title>
<polygon fill="#ffffff" stroke="black" points="15336,-282.5 15336,-318.5 15411,-318.5 15411,-282.5 15336,-282.5"/>
<text text-anchor="middle" x="15373.5" y="-296.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_15&#45;&gt;drop_ffn_15 -->
<g id="edge126" class="edge">
<title>ffn_15&#45;&gt;drop_ffn_15</title>
<path fill="none" stroke="black" d="M15299.15,-300.5C15308.18,-300.5 15317.23,-300.5 15325.73,-300.5"/>
<polygon fill="black" stroke="black" points="15325.8,-304 15335.8,-300.5 15325.8,-297 15325.8,-304"/>
</g>
<!-- residual_out_15 -->
<g id="node114" class="node">
<title>residual_out_15</title>
<polygon fill="#f4f6f8" stroke="black" points="15489,-325.5 15489,-361.5 15618,-361.5 15618,-325.5 15489,-325.5"/>
<text text-anchor="middle" x="15553.5" y="-339.8" font-family="Times,serif" font-size="14.00">residual_out_15</text>
</g>
<!-- drop_ffn_15&#45;&gt;residual_out_15 -->
<!-- norm_attn_16 -->
<g id="node115" class="node">
<title>norm_attn_16</title>
<polygon fill="#ffffff" stroke="black" points="15507.5,-244.5 15507.5,-280.5 15599.5,-280.5 15599.5,-244.5 15507.5,-244.5"/>
<text text-anchor="middle" x="15553.5" y="-258.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_15&#45;&gt;norm_attn_16 -->
<g id="edge135" class="edge">
<title>drop_ffn_15&#45;&gt;norm_attn_16</title>
<path fill="none" stroke="black" d="M15411.38,-292.63C15436.23,-287.32 15469.45,-280.23 15497.42,-274.26"/>
<polygon fill="black" stroke="black" points="15498.41,-277.63 15507.46,-272.12 15496.95,-270.78 15498.41,-277.63"/>
<text text-anchor="middle" x="15450" y="-291.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_16 -->
<g id="node116" class="node">
<title>attn_16</title>
<polygon fill="#ffffff" stroke="black" points="15655,-204 15655,-287 15820,-287 15820,-204 15655,-204"/>
<text text-anchor="middle" x="15737.5" y="-271.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="15737.5" y="-256.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="15737.5" y="-241.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="15737.5" y="-226.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="15737.5" y="-211.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_16&#45;&gt;attn_16 -->
<g id="edge130" class="edge">
<title>norm_attn_16&#45;&gt;attn_16</title>
<path fill="none" stroke="black" d="M15599.96,-258.25C15613.6,-256.98 15629.09,-255.53 15644.61,-254.08"/>
<polygon fill="black" stroke="black" points="15645.17,-257.55 15654.8,-253.13 15644.52,-250.58 15645.17,-257.55"/>
</g>
<!-- drop_attn_16 -->
<g id="node117" class="node">
<title>drop_attn_16</title>
<polygon fill="#ffffff" stroke="black" points="15857,-227.5 15857,-263.5 15932,-263.5 15932,-227.5 15857,-227.5"/>
<text text-anchor="middle" x="15894.5" y="-241.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_16&#45;&gt;drop_attn_16 -->
<g id="edge131" class="edge">
<title>attn_16&#45;&gt;drop_attn_16</title>
<path fill="none" stroke="black" d="M15820.09,-245.5C15829.21,-245.5 15838.26,-245.5 15846.73,-245.5"/>
<polygon fill="black" stroke="black" points="15846.73,-249 15856.73,-245.5 15846.73,-242 15846.73,-249"/>
</g>
<!-- norm_ffn_16 -->
<g id="node118" class="node">
<title>norm_ffn_16</title>
<polygon fill="#ffffff" stroke="black" points="15969,-227.5 15969,-263.5 16061,-263.5 16061,-227.5 15969,-227.5"/>
<text text-anchor="middle" x="16015" y="-241.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_16&#45;&gt;norm_ffn_16 -->
<g id="edge132" class="edge">
<title>drop_attn_16&#45;&gt;norm_ffn_16</title>
<path fill="none" stroke="black" d="M15932.02,-245.5C15940.42,-245.5 15949.54,-245.5 15958.54,-245.5"/>
<polygon fill="black" stroke="black" points="15958.61,-249 15968.61,-245.5 15958.61,-242 15958.61,-249"/>
</g>
<!-- ffn_16 -->
<g id="node119" class="node">
<title>ffn_16</title>
<polygon fill="#ffffff" stroke="black" points="16098,-226.5 16098,-264.5 16243,-264.5 16243,-226.5 16098,-226.5"/>
<text text-anchor="middle" x="16170.5" y="-249.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="16170.5" y="-234.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_16&#45;&gt;ffn_16 -->
<g id="edge133" class="edge">
<title>norm_ffn_16&#45;&gt;ffn_16</title>
<path fill="none" stroke="black" d="M16061.22,-245.5C16069.58,-245.5 16078.53,-245.5 16087.59,-245.5"/>
<polygon fill="black" stroke="black" points="16087.82,-249 16097.82,-245.5 16087.82,-242 16087.82,-249"/>
</g>
<!-- drop_ffn_16 -->
<g id="node120" class="node">
<title>drop_ffn_16</title>
<polygon fill="#ffffff" stroke="black" points="16280,-227.5 16280,-263.5 16355,-263.5 16355,-227.5 16280,-227.5"/>
<text text-anchor="middle" x="16317.5" y="-241.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_16&#45;&gt;drop_ffn_16 -->
<g id="edge134" class="edge">
<title>ffn_16&#45;&gt;drop_ffn_16</title>
<path fill="none" stroke="black" d="M16243.15,-245.5C16252.18,-245.5 16261.23,-245.5 16269.73,-245.5"/>
<polygon fill="black" stroke="black" points="16269.8,-249 16279.8,-245.5 16269.8,-242 16269.8,-249"/>
</g>
<!-- residual_out_16 -->
<g id="node121" class="node">
<title>residual_out_16</title>
<polygon fill="#f4f6f8" stroke="black" points="16433,-243.5 16433,-279.5 16562,-279.5 16562,-243.5 16433,-243.5"/>
<text text-anchor="middle" x="16497.5" y="-257.8" font-family="Times,serif" font-size="14.00">residual_out_16</text>
</g>
<!-- drop_ffn_16&#45;&gt;residual_out_16 -->
<!-- norm_attn_17 -->
<g id="node122" class="node">
<title>norm_attn_17</title>
<polygon fill="#ffffff" stroke="black" points="16451.5,-162.5 16451.5,-198.5 16543.5,-198.5 16543.5,-162.5 16451.5,-162.5"/>
<text text-anchor="middle" x="16497.5" y="-176.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_16&#45;&gt;norm_attn_17 -->
<g id="edge143" class="edge">
<title>drop_ffn_16&#45;&gt;norm_attn_17</title>
<path fill="none" stroke="black" d="M16355.38,-232.03C16380.34,-222.92 16413.74,-210.72 16441.78,-200.48"/>
<polygon fill="black" stroke="black" points="16443.26,-203.67 16451.46,-196.95 16440.86,-197.09 16443.26,-203.67"/>
<text text-anchor="middle" x="16394" y="-227.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_17 -->
<g id="node123" class="node">
<title>attn_17</title>
<polygon fill="#ffffff" stroke="black" points="16599,-122 16599,-205 16764,-205 16764,-122 16599,-122"/>
<text text-anchor="middle" x="16681.5" y="-189.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="16681.5" y="-174.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="16681.5" y="-159.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="16681.5" y="-144.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="16681.5" y="-129.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_17&#45;&gt;attn_17 -->
<g id="edge138" class="edge">
<title>norm_attn_17&#45;&gt;attn_17</title>
<path fill="none" stroke="black" d="M16543.96,-176.25C16557.6,-174.98 16573.09,-173.53 16588.61,-172.08"/>
<polygon fill="black" stroke="black" points="16589.17,-175.55 16598.8,-171.13 16588.52,-168.58 16589.17,-175.55"/>
</g>
<!-- drop_attn_17 -->
<g id="node124" class="node">
<title>drop_attn_17</title>
<polygon fill="#ffffff" stroke="black" points="16801,-145.5 16801,-181.5 16876,-181.5 16876,-145.5 16801,-145.5"/>
<text text-anchor="middle" x="16838.5" y="-159.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_17&#45;&gt;drop_attn_17 -->
<g id="edge139" class="edge">
<title>attn_17&#45;&gt;drop_attn_17</title>
<path fill="none" stroke="black" d="M16764.09,-163.5C16773.21,-163.5 16782.26,-163.5 16790.73,-163.5"/>
<polygon fill="black" stroke="black" points="16790.73,-167 16800.73,-163.5 16790.73,-160 16790.73,-167"/>
</g>
<!-- norm_ffn_17 -->
<g id="node125" class="node">
<title>norm_ffn_17</title>
<polygon fill="#ffffff" stroke="black" points="16913,-145.5 16913,-181.5 17005,-181.5 17005,-145.5 16913,-145.5"/>
<text text-anchor="middle" x="16959" y="-159.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_17&#45;&gt;norm_ffn_17 -->
<g id="edge140" class="edge">
<title>drop_attn_17&#45;&gt;norm_ffn_17</title>
<path fill="none" stroke="black" d="M16876.02,-163.5C16884.42,-163.5 16893.54,-163.5 16902.54,-163.5"/>
<polygon fill="black" stroke="black" points="16902.61,-167 16912.61,-163.5 16902.61,-160 16902.61,-167"/>
</g>
<!-- ffn_17 -->
<g id="node126" class="node">
<title>ffn_17</title>
<polygon fill="#ffffff" stroke="black" points="17042,-144.5 17042,-182.5 17187,-182.5 17187,-144.5 17042,-144.5"/>
<text text-anchor="middle" x="17114.5" y="-167.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="17114.5" y="-152.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_17&#45;&gt;ffn_17 -->
<g id="edge141" class="edge">
<title>norm_ffn_17&#45;&gt;ffn_17</title>
<path fill="none" stroke="black" d="M17005.22,-163.5C17013.58,-163.5 17022.53,-163.5 17031.59,-163.5"/>
<polygon fill="black" stroke="black" points="17031.82,-167 17041.82,-163.5 17031.82,-160 17031.82,-167"/>
</g>
<!-- drop_ffn_17 -->
<g id="node127" class="node">
<title>drop_ffn_17</title>
<polygon fill="#ffffff" stroke="black" points="17224,-145.5 17224,-181.5 17299,-181.5 17299,-145.5 17224,-145.5"/>
<text text-anchor="middle" x="17261.5" y="-159.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_17&#45;&gt;drop_ffn_17 -->
<g id="edge142" class="edge">
<title>ffn_17&#45;&gt;drop_ffn_17</title>
<path fill="none" stroke="black" d="M17187.15,-163.5C17196.18,-163.5 17205.23,-163.5 17213.73,-163.5"/>
<polygon fill="black" stroke="black" points="17213.8,-167 17223.8,-163.5 17213.8,-160 17213.8,-167"/>
</g>
<!-- residual_out_17 -->
<g id="node128" class="node">
<title>residual_out_17</title>
<polygon fill="#f4f6f8" stroke="black" points="17377,-165.5 17377,-201.5 17506,-201.5 17506,-165.5 17377,-165.5"/>
<text text-anchor="middle" x="17441.5" y="-179.8" font-family="Times,serif" font-size="14.00">residual_out_17</text>
</g>
<!-- drop_ffn_17&#45;&gt;residual_out_17 -->
<!-- norm_attn_18 -->
<g id="node129" class="node">
<title>norm_attn_18</title>
<polygon fill="#ffffff" stroke="black" points="17395.5,-84.5 17395.5,-120.5 17487.5,-120.5 17487.5,-84.5 17395.5,-84.5"/>
<text text-anchor="middle" x="17441.5" y="-98.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_17&#45;&gt;norm_attn_18 -->
<g id="edge151" class="edge">
<title>drop_ffn_17&#45;&gt;norm_attn_18</title>
<path fill="none" stroke="black" d="M17299.38,-150.86C17324.34,-142.31 17357.74,-130.86 17385.78,-121.25"/>
<polygon fill="black" stroke="black" points="17387.13,-124.49 17395.46,-117.94 17384.86,-117.87 17387.13,-124.49"/>
<text text-anchor="middle" x="17338" y="-147.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_18 -->
<g id="node130" class="node">
<title>attn_18</title>
<polygon fill="#ffffff" stroke="black" points="17543,-44 17543,-127 17708,-127 17708,-44 17543,-44"/>
<text text-anchor="middle" x="17625.5" y="-111.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="17625.5" y="-96.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="17625.5" y="-81.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="17625.5" y="-66.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="17625.5" y="-51.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_18&#45;&gt;attn_18 -->
<g id="edge146" class="edge">
<title>norm_attn_18&#45;&gt;attn_18</title>
<path fill="none" stroke="black" d="M17487.96,-98.25C17501.6,-96.98 17517.09,-95.53 17532.61,-94.08"/>
<polygon fill="black" stroke="black" points="17533.17,-97.55 17542.8,-93.13 17532.52,-90.58 17533.17,-97.55"/>
</g>
<!-- drop_attn_18 -->
<g id="node131" class="node">
<title>drop_attn_18</title>
<polygon fill="#ffffff" stroke="black" points="17745,-67.5 17745,-103.5 17820,-103.5 17820,-67.5 17745,-67.5"/>
<text text-anchor="middle" x="17782.5" y="-81.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_18&#45;&gt;drop_attn_18 -->
<g id="edge147" class="edge">
<title>attn_18&#45;&gt;drop_attn_18</title>
<path fill="none" stroke="black" d="M17708.09,-85.5C17717.21,-85.5 17726.26,-85.5 17734.73,-85.5"/>
<polygon fill="black" stroke="black" points="17734.73,-89 17744.73,-85.5 17734.73,-82 17734.73,-89"/>
</g>
<!-- norm_ffn_18 -->
<g id="node132" class="node">
<title>norm_ffn_18</title>
<polygon fill="#ffffff" stroke="black" points="17857,-67.5 17857,-103.5 17949,-103.5 17949,-67.5 17857,-67.5"/>
<text text-anchor="middle" x="17903" y="-81.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_18&#45;&gt;norm_ffn_18 -->
<g id="edge148" class="edge">
<title>drop_attn_18&#45;&gt;norm_ffn_18</title>
<path fill="none" stroke="black" d="M17820.02,-85.5C17828.42,-85.5 17837.54,-85.5 17846.54,-85.5"/>
<polygon fill="black" stroke="black" points="17846.61,-89 17856.61,-85.5 17846.61,-82 17846.61,-89"/>
</g>
<!-- ffn_18 -->
<g id="node133" class="node">
<title>ffn_18</title>
<polygon fill="#ffffff" stroke="black" points="17986,-66.5 17986,-104.5 18131,-104.5 18131,-66.5 17986,-66.5"/>
<text text-anchor="middle" x="18058.5" y="-89.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="18058.5" y="-74.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_18&#45;&gt;ffn_18 -->
<g id="edge149" class="edge">
<title>norm_ffn_18&#45;&gt;ffn_18</title>
<path fill="none" stroke="black" d="M17949.22,-85.5C17957.58,-85.5 17966.53,-85.5 17975.59,-85.5"/>
<polygon fill="black" stroke="black" points="17975.82,-89 17985.82,-85.5 17975.82,-82 17975.82,-89"/>
</g>
<!-- drop_ffn_18 -->
<g id="node134" class="node">
<title>drop_ffn_18</title>
<polygon fill="#ffffff" stroke="black" points="18168,-67.5 18168,-103.5 18243,-103.5 18243,-67.5 18168,-67.5"/>
<text text-anchor="middle" x="18205.5" y="-81.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_18&#45;&gt;drop_ffn_18 -->
<g id="edge150" class="edge">
<title>ffn_18&#45;&gt;drop_ffn_18</title>
<path fill="none" stroke="black" d="M18131.15,-85.5C18140.18,-85.5 18149.23,-85.5 18157.73,-85.5"/>
<polygon fill="black" stroke="black" points="18157.8,-89 18167.8,-85.5 18157.8,-82 18157.8,-89"/>
</g>
<!-- residual_out_18 -->
<g id="node135" class="node">
<title>residual_out_18</title>
<polygon fill="#f4f6f8" stroke="black" points="18321,-159.5 18321,-195.5 18450,-195.5 18450,-159.5 18321,-159.5"/>
<text text-anchor="middle" x="18385.5" y="-173.8" font-family="Times,serif" font-size="14.00">residual_out_18</text>
</g>
<!-- drop_ffn_18&#45;&gt;residual_out_18 -->
<!-- norm_attn_19 -->
<g id="node136" class="node">
<title>norm_attn_19</title>
<polygon fill="#ffffff" stroke="black" points="18339.5,-63.5 18339.5,-99.5 18431.5,-99.5 18431.5,-63.5 18339.5,-63.5"/>
<text text-anchor="middle" x="18385.5" y="-77.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_18&#45;&gt;norm_attn_19 -->
<g id="edge159" class="edge">
<title>drop_ffn_18&#45;&gt;norm_attn_19</title>
<path fill="none" stroke="black" d="M18243.38,-84.67C18268.23,-84.11 18301.45,-83.37 18329.42,-82.74"/>
<polygon fill="black" stroke="black" points="18329.54,-86.24 18339.46,-82.51 18329.38,-79.24 18329.54,-86.24"/>
<text text-anchor="middle" x="18282" y="-87.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_19 -->
<g id="node137" class="node">
<title>attn_19</title>
<polygon fill="#ffffff" stroke="black" points="18487,-38 18487,-121 18652,-121 18652,-38 18487,-38"/>
<text text-anchor="middle" x="18569.5" y="-105.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="18569.5" y="-90.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="18569.5" y="-75.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="18569.5" y="-60.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="18569.5" y="-45.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_19&#45;&gt;attn_19 -->
<g id="edge154" class="edge">
<title>norm_attn_19&#45;&gt;attn_19</title>
<path fill="none" stroke="black" d="M18431.96,-81C18445.6,-80.85 18461.09,-80.68 18476.61,-80.51"/>
<polygon fill="black" stroke="black" points="18476.84,-84.01 18486.8,-80.4 18476.76,-77.01 18476.84,-84.01"/>
</g>
<!-- drop_attn_19 -->
<g id="node138" class="node">
<title>drop_attn_19</title>
<polygon fill="#ffffff" stroke="black" points="18689,-61.5 18689,-97.5 18764,-97.5 18764,-61.5 18689,-61.5"/>
<text text-anchor="middle" x="18726.5" y="-75.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_19&#45;&gt;drop_attn_19 -->
<g id="edge155" class="edge">
<title>attn_19&#45;&gt;drop_attn_19</title>
<path fill="none" stroke="black" d="M18652.09,-79.5C18661.21,-79.5 18670.26,-79.5 18678.73,-79.5"/>
<polygon fill="black" stroke="black" points="18678.73,-83 18688.73,-79.5 18678.73,-76 18678.73,-83"/>
</g>
<!-- norm_ffn_19 -->
<g id="node139" class="node">
<title>norm_ffn_19</title>
<polygon fill="#ffffff" stroke="black" points="18801,-61.5 18801,-97.5 18893,-97.5 18893,-61.5 18801,-61.5"/>
<text text-anchor="middle" x="18847" y="-75.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_19&#45;&gt;norm_ffn_19 -->
<g id="edge156" class="edge">
<title>drop_attn_19&#45;&gt;norm_ffn_19</title>
<path fill="none" stroke="black" d="M18764.02,-79.5C18772.42,-79.5 18781.54,-79.5 18790.54,-79.5"/>
<polygon fill="black" stroke="black" points="18790.61,-83 18800.61,-79.5 18790.61,-76 18790.61,-83"/>
</g>
<!-- ffn_19 -->
<g id="node140" class="node">
<title>ffn_19</title>
<polygon fill="#ffffff" stroke="black" points="18930,-60.5 18930,-98.5 19075,-98.5 19075,-60.5 18930,-60.5"/>
<text text-anchor="middle" x="19002.5" y="-83.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="19002.5" y="-68.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_19&#45;&gt;ffn_19 -->
<g id="edge157" class="edge">
<title>norm_ffn_19&#45;&gt;ffn_19</title>
<path fill="none" stroke="black" d="M18893.22,-79.5C18901.58,-79.5 18910.53,-79.5 18919.59,-79.5"/>
<polygon fill="black" stroke="black" points="18919.82,-83 18929.82,-79.5 18919.82,-76 18919.82,-83"/>
</g>
<!-- drop_ffn_19 -->
<g id="node141" class="node">
<title>drop_ffn_19</title>
<polygon fill="#ffffff" stroke="black" points="19112,-61.5 19112,-97.5 19187,-97.5 19187,-61.5 19112,-61.5"/>
<text text-anchor="middle" x="19149.5" y="-75.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_19&#45;&gt;drop_ffn_19 -->
<g id="edge158" class="edge">
<title>ffn_19&#45;&gt;drop_ffn_19</title>
<path fill="none" stroke="black" d="M19075.15,-79.5C19084.18,-79.5 19093.23,-79.5 19101.73,-79.5"/>
<polygon fill="black" stroke="black" points="19101.8,-83 19111.8,-79.5 19101.8,-76 19101.8,-83"/>
</g>
<!-- residual_out_19 -->
<g id="node142" class="node">
<title>residual_out_19</title>
<polygon fill="#f4f6f8" stroke="black" points="19265,-156.5 19265,-192.5 19394,-192.5 19394,-156.5 19265,-156.5"/>
<text text-anchor="middle" x="19329.5" y="-170.8" font-family="Times,serif" font-size="14.00">residual_out_19</text>
</g>
<!-- drop_ffn_19&#45;&gt;residual_out_19 -->
<!-- norm_attn_20 -->
<g id="node143" class="node">
<title>norm_attn_20</title>
<polygon fill="#ffffff" stroke="black" points="19283.5,-59.5 19283.5,-95.5 19375.5,-95.5 19375.5,-59.5 19283.5,-59.5"/>
<text text-anchor="middle" x="19329.5" y="-73.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_19&#45;&gt;norm_attn_20 -->
<g id="edge167" class="edge">
<title>drop_ffn_19&#45;&gt;norm_attn_20</title>
<path fill="none" stroke="black" d="M19187.38,-79.09C19212.23,-78.81 19245.45,-78.43 19273.42,-78.12"/>
<polygon fill="black" stroke="black" points="19273.5,-81.62 19283.46,-78.01 19273.42,-74.62 19273.5,-81.62"/>
<text text-anchor="middle" x="19226" y="-82.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_20 -->
<g id="node144" class="node">
<title>attn_20</title>
<polygon fill="#ffffff" stroke="black" points="19431,-35 19431,-118 19596,-118 19596,-35 19431,-35"/>
<text text-anchor="middle" x="19513.5" y="-102.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="19513.5" y="-87.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="19513.5" y="-72.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="19513.5" y="-57.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="19513.5" y="-42.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_20&#45;&gt;attn_20 -->
<g id="edge162" class="edge">
<title>norm_attn_20&#45;&gt;attn_20</title>
<path fill="none" stroke="black" d="M19375.96,-77.25C19389.6,-77.18 19405.09,-77.09 19420.61,-77"/>
<polygon fill="black" stroke="black" points="19420.82,-80.5 19430.8,-76.95 19420.78,-73.5 19420.82,-80.5"/>
</g>
<!-- drop_attn_20 -->
<g id="node145" class="node">
<title>drop_attn_20</title>
<polygon fill="#ffffff" stroke="black" points="19633,-58.5 19633,-94.5 19708,-94.5 19708,-58.5 19633,-58.5"/>
<text text-anchor="middle" x="19670.5" y="-72.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_20&#45;&gt;drop_attn_20 -->
<g id="edge163" class="edge">
<title>attn_20&#45;&gt;drop_attn_20</title>
<path fill="none" stroke="black" d="M19596.09,-76.5C19605.21,-76.5 19614.26,-76.5 19622.73,-76.5"/>
<polygon fill="black" stroke="black" points="19622.73,-80 19632.73,-76.5 19622.73,-73 19622.73,-80"/>
</g>
<!-- norm_ffn_20 -->
<g id="node146" class="node">
<title>norm_ffn_20</title>
<polygon fill="#ffffff" stroke="black" points="19745,-58.5 19745,-94.5 19837,-94.5 19837,-58.5 19745,-58.5"/>
<text text-anchor="middle" x="19791" y="-72.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_20&#45;&gt;norm_ffn_20 -->
<g id="edge164" class="edge">
<title>drop_attn_20&#45;&gt;norm_ffn_20</title>
<path fill="none" stroke="black" d="M19708.02,-76.5C19716.42,-76.5 19725.54,-76.5 19734.54,-76.5"/>
<polygon fill="black" stroke="black" points="19734.61,-80 19744.61,-76.5 19734.61,-73 19734.61,-80"/>
</g>
<!-- ffn_20 -->
<g id="node147" class="node">
<title>ffn_20</title>
<polygon fill="#ffffff" stroke="black" points="19874,-57.5 19874,-95.5 20019,-95.5 20019,-57.5 19874,-57.5"/>
<text text-anchor="middle" x="19946.5" y="-80.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="19946.5" y="-65.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_20&#45;&gt;ffn_20 -->
<g id="edge165" class="edge">
<title>norm_ffn_20&#45;&gt;ffn_20</title>
<path fill="none" stroke="black" d="M19837.22,-76.5C19845.58,-76.5 19854.53,-76.5 19863.59,-76.5"/>
<polygon fill="black" stroke="black" points="19863.82,-80 19873.82,-76.5 19863.82,-73 19863.82,-80"/>
</g>
<!-- drop_ffn_20 -->
<g id="node148" class="node">
<title>drop_ffn_20</title>
<polygon fill="#ffffff" stroke="black" points="20056,-58.5 20056,-94.5 20131,-94.5 20131,-58.5 20056,-58.5"/>
<text text-anchor="middle" x="20093.5" y="-72.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_20&#45;&gt;drop_ffn_20 -->
<g id="edge166" class="edge">
<title>ffn_20&#45;&gt;drop_ffn_20</title>
<path fill="none" stroke="black" d="M20019.15,-76.5C20028.18,-76.5 20037.23,-76.5 20045.73,-76.5"/>
<polygon fill="black" stroke="black" points="20045.8,-80 20055.8,-76.5 20045.8,-73 20045.8,-80"/>
</g>
<!-- residual_out_20 -->
<g id="node149" class="node">
<title>residual_out_20</title>
<polygon fill="#f4f6f8" stroke="black" points="20209,-154.5 20209,-190.5 20338,-190.5 20338,-154.5 20209,-154.5"/>
<text text-anchor="middle" x="20273.5" y="-168.8" font-family="Times,serif" font-size="14.00">residual_out_20</text>
</g>
<!-- drop_ffn_20&#45;&gt;residual_out_20 -->
<!-- norm_attn_21 -->
<g id="node150" class="node">
<title>norm_attn_21</title>
<polygon fill="#ffffff" stroke="black" points="20227.5,-57.5 20227.5,-93.5 20319.5,-93.5 20319.5,-57.5 20227.5,-57.5"/>
<text text-anchor="middle" x="20273.5" y="-71.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_20&#45;&gt;norm_attn_21 -->
<g id="edge175" class="edge">
<title>drop_ffn_20&#45;&gt;norm_attn_21</title>
<path fill="none" stroke="black" d="M20131.38,-76.29C20156.23,-76.15 20189.45,-75.97 20217.42,-75.81"/>
<polygon fill="black" stroke="black" points="20217.48,-79.31 20227.46,-75.75 20217.44,-72.31 20217.48,-79.31"/>
<text text-anchor="middle" x="20170" y="-79.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_21 -->
<g id="node151" class="node">
<title>attn_21</title>
<polygon fill="#ffffff" stroke="black" points="20375,-33 20375,-116 20540,-116 20540,-33 20375,-33"/>
<text text-anchor="middle" x="20457.5" y="-100.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="20457.5" y="-85.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="20457.5" y="-70.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="20457.5" y="-55.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="20457.5" y="-40.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_21&#45;&gt;attn_21 -->
<g id="edge170" class="edge">
<title>norm_attn_21&#45;&gt;attn_21</title>
<path fill="none" stroke="black" d="M20319.96,-75.25C20333.6,-75.18 20349.09,-75.09 20364.61,-75"/>
<polygon fill="black" stroke="black" points="20364.82,-78.5 20374.8,-74.95 20364.78,-71.5 20364.82,-78.5"/>
</g>
<!-- drop_attn_21 -->
<g id="node152" class="node">
<title>drop_attn_21</title>
<polygon fill="#ffffff" stroke="black" points="20577,-56.5 20577,-92.5 20652,-92.5 20652,-56.5 20577,-56.5"/>
<text text-anchor="middle" x="20614.5" y="-70.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_21&#45;&gt;drop_attn_21 -->
<g id="edge171" class="edge">
<title>attn_21&#45;&gt;drop_attn_21</title>
<path fill="none" stroke="black" d="M20540.09,-74.5C20549.21,-74.5 20558.26,-74.5 20566.73,-74.5"/>
<polygon fill="black" stroke="black" points="20566.73,-78 20576.73,-74.5 20566.73,-71 20566.73,-78"/>
</g>
<!-- norm_ffn_21 -->
<g id="node153" class="node">
<title>norm_ffn_21</title>
<polygon fill="#ffffff" stroke="black" points="20689,-56.5 20689,-92.5 20781,-92.5 20781,-56.5 20689,-56.5"/>
<text text-anchor="middle" x="20735" y="-70.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_21&#45;&gt;norm_ffn_21 -->
<g id="edge172" class="edge">
<title>drop_attn_21&#45;&gt;norm_ffn_21</title>
<path fill="none" stroke="black" d="M20652.02,-74.5C20660.42,-74.5 20669.54,-74.5 20678.54,-74.5"/>
<polygon fill="black" stroke="black" points="20678.61,-78 20688.61,-74.5 20678.61,-71 20678.61,-78"/>
</g>
<!-- ffn_21 -->
<g id="node154" class="node">
<title>ffn_21</title>
<polygon fill="#ffffff" stroke="black" points="20818,-55.5 20818,-93.5 20963,-93.5 20963,-55.5 20818,-55.5"/>
<text text-anchor="middle" x="20890.5" y="-78.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="20890.5" y="-63.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_21&#45;&gt;ffn_21 -->
<g id="edge173" class="edge">
<title>norm_ffn_21&#45;&gt;ffn_21</title>
<path fill="none" stroke="black" d="M20781.22,-74.5C20789.58,-74.5 20798.53,-74.5 20807.59,-74.5"/>
<polygon fill="black" stroke="black" points="20807.82,-78 20817.82,-74.5 20807.82,-71 20807.82,-78"/>
</g>
<!-- drop_ffn_21 -->
<g id="node155" class="node">
<title>drop_ffn_21</title>
<polygon fill="#ffffff" stroke="black" points="21000,-56.5 21000,-92.5 21075,-92.5 21075,-56.5 21000,-56.5"/>
<text text-anchor="middle" x="21037.5" y="-70.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_21&#45;&gt;drop_ffn_21 -->
<g id="edge174" class="edge">
<title>ffn_21&#45;&gt;drop_ffn_21</title>
<path fill="none" stroke="black" d="M20963.15,-74.5C20972.18,-74.5 20981.23,-74.5 20989.73,-74.5"/>
<polygon fill="black" stroke="black" points="20989.8,-78 20999.8,-74.5 20989.8,-71 20989.8,-78"/>
</g>
<!-- residual_out_21 -->
<g id="node156" class="node">
<title>residual_out_21</title>
<polygon fill="#f4f6f8" stroke="black" points="21153,-154.5 21153,-190.5 21282,-190.5 21282,-154.5 21153,-154.5"/>
<text text-anchor="middle" x="21217.5" y="-168.8" font-family="Times,serif" font-size="14.00">residual_out_21</text>
</g>
<!-- drop_ffn_21&#45;&gt;residual_out_21 -->
<!-- norm_attn_22 -->
<g id="node157" class="node">
<title>norm_attn_22</title>
<polygon fill="#ffffff" stroke="black" points="21171.5,-56.5 21171.5,-92.5 21263.5,-92.5 21263.5,-56.5 21171.5,-56.5"/>
<text text-anchor="middle" x="21217.5" y="-70.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_21&#45;&gt;norm_attn_22 -->
<g id="edge183" class="edge">
<title>drop_ffn_21&#45;&gt;norm_attn_22</title>
<path fill="none" stroke="black" d="M21075.38,-74.5C21100.23,-74.5 21133.45,-74.5 21161.42,-74.5"/>
<polygon fill="black" stroke="black" points="21161.46,-78 21171.46,-74.5 21161.46,-71 21161.46,-78"/>
<text text-anchor="middle" x="21114" y="-77.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_22 -->
<g id="node158" class="node">
<title>attn_22</title>
<polygon fill="#ffffff" stroke="black" points="21319,-33 21319,-116 21484,-116 21484,-33 21319,-33"/>
<text text-anchor="middle" x="21401.5" y="-100.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="21401.5" y="-85.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="21401.5" y="-70.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="21401.5" y="-55.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="21401.5" y="-40.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_22&#45;&gt;attn_22 -->
<g id="edge178" class="edge">
<title>norm_attn_22&#45;&gt;attn_22</title>
<path fill="none" stroke="black" d="M21263.96,-74.5C21277.6,-74.5 21293.09,-74.5 21308.61,-74.5"/>
<polygon fill="black" stroke="black" points="21308.8,-78 21318.8,-74.5 21308.8,-71 21308.8,-78"/>
</g>
<!-- drop_attn_22 -->
<g id="node159" class="node">
<title>drop_attn_22</title>
<polygon fill="#ffffff" stroke="black" points="21521,-56.5 21521,-92.5 21596,-92.5 21596,-56.5 21521,-56.5"/>
<text text-anchor="middle" x="21558.5" y="-70.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_22&#45;&gt;drop_attn_22 -->
<g id="edge179" class="edge">
<title>attn_22&#45;&gt;drop_attn_22</title>
<path fill="none" stroke="black" d="M21484.09,-74.5C21493.21,-74.5 21502.26,-74.5 21510.73,-74.5"/>
<polygon fill="black" stroke="black" points="21510.73,-78 21520.73,-74.5 21510.73,-71 21510.73,-78"/>
</g>
<!-- norm_ffn_22 -->
<g id="node160" class="node">
<title>norm_ffn_22</title>
<polygon fill="#ffffff" stroke="black" points="21633,-56.5 21633,-92.5 21725,-92.5 21725,-56.5 21633,-56.5"/>
<text text-anchor="middle" x="21679" y="-70.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_22&#45;&gt;norm_ffn_22 -->
<g id="edge180" class="edge">
<title>drop_attn_22&#45;&gt;norm_ffn_22</title>
<path fill="none" stroke="black" d="M21596.02,-74.5C21604.42,-74.5 21613.54,-74.5 21622.54,-74.5"/>
<polygon fill="black" stroke="black" points="21622.61,-78 21632.61,-74.5 21622.61,-71 21622.61,-78"/>
</g>
<!-- ffn_22 -->
<g id="node161" class="node">
<title>ffn_22</title>
<polygon fill="#ffffff" stroke="black" points="21762,-55.5 21762,-93.5 21907,-93.5 21907,-55.5 21762,-55.5"/>
<text text-anchor="middle" x="21834.5" y="-78.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="21834.5" y="-63.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_22&#45;&gt;ffn_22 -->
<g id="edge181" class="edge">
<title>norm_ffn_22&#45;&gt;ffn_22</title>
<path fill="none" stroke="black" d="M21725.22,-74.5C21733.58,-74.5 21742.53,-74.5 21751.59,-74.5"/>
<polygon fill="black" stroke="black" points="21751.82,-78 21761.82,-74.5 21751.82,-71 21751.82,-78"/>
</g>
<!-- drop_ffn_22 -->
<g id="node162" class="node">
<title>drop_ffn_22</title>
<polygon fill="#ffffff" stroke="black" points="21944,-56.5 21944,-92.5 22019,-92.5 22019,-56.5 21944,-56.5"/>
<text text-anchor="middle" x="21981.5" y="-70.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_22&#45;&gt;drop_ffn_22 -->
<g id="edge182" class="edge">
<title>ffn_22&#45;&gt;drop_ffn_22</title>
<path fill="none" stroke="black" d="M21907.15,-74.5C21916.18,-74.5 21925.23,-74.5 21933.73,-74.5"/>
<polygon fill="black" stroke="black" points="21933.8,-78 21943.8,-74.5 21933.8,-71 21933.8,-78"/>
</g>
<!-- residual_out_22 -->
<g id="node163" class="node">
<title>residual_out_22</title>
<polygon fill="#f4f6f8" stroke="black" points="22097,-154.5 22097,-190.5 22226,-190.5 22226,-154.5 22097,-154.5"/>
<text text-anchor="middle" x="22161.5" y="-168.8" font-family="Times,serif" font-size="14.00">residual_out_22</text>
</g>
<!-- drop_ffn_22&#45;&gt;residual_out_22 -->
<!-- norm_attn_23 -->
<g id="node164" class="node">
<title>norm_attn_23</title>
<polygon fill="#ffffff" stroke="black" points="22115.5,-56.5 22115.5,-92.5 22207.5,-92.5 22207.5,-56.5 22115.5,-56.5"/>
<text text-anchor="middle" x="22161.5" y="-70.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_22&#45;&gt;norm_attn_23 -->
<g id="edge191" class="edge">
<title>drop_ffn_22&#45;&gt;norm_attn_23</title>
<path fill="none" stroke="black" d="M22019.38,-74.5C22044.23,-74.5 22077.45,-74.5 22105.42,-74.5"/>
<polygon fill="black" stroke="black" points="22105.46,-78 22115.46,-74.5 22105.46,-71 22105.46,-78"/>
<text text-anchor="middle" x="22058" y="-77.5" font-family="Times,serif" font-size="10.00">residual</text>
</g>
<!-- attn_23 -->
<g id="node165" class="node">
<title>attn_23</title>
<polygon fill="#ffffff" stroke="black" points="22263,-33 22263,-116 22428,-116 22428,-33 22263,-33"/>
<text text-anchor="middle" x="22345.5" y="-100.8" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
<text text-anchor="middle" x="22345.5" y="-85.8" font-family="Times,serif" font-size="14.00">Q heads: 16</text>
<text text-anchor="middle" x="22345.5" y="-70.8" font-family="Times,serif" font-size="14.00">KV heads: 16</text>
<text text-anchor="middle" x="22345.5" y="-55.8" font-family="Times,serif" font-size="14.00">Head dim: 64</text>
<text text-anchor="middle" x="22345.5" y="-40.8" font-family="Times,serif" font-size="14.00">RoPE theta: 10000.0</text>
</g>
<!-- norm_attn_23&#45;&gt;attn_23 -->
<g id="edge186" class="edge">
<title>norm_attn_23&#45;&gt;attn_23</title>
<path fill="none" stroke="black" d="M22207.96,-74.5C22221.6,-74.5 22237.09,-74.5 22252.61,-74.5"/>
<polygon fill="black" stroke="black" points="22252.8,-78 22262.8,-74.5 22252.8,-71 22252.8,-78"/>
</g>
<!-- drop_attn_23 -->
<g id="node166" class="node">
<title>drop_attn_23</title>
<polygon fill="#ffffff" stroke="black" points="22465,-56.5 22465,-92.5 22540,-92.5 22540,-56.5 22465,-56.5"/>
<text text-anchor="middle" x="22502.5" y="-70.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- attn_23&#45;&gt;drop_attn_23 -->
<g id="edge187" class="edge">
<title>attn_23&#45;&gt;drop_attn_23</title>
<path fill="none" stroke="black" d="M22428.09,-74.5C22437.21,-74.5 22446.26,-74.5 22454.73,-74.5"/>
<polygon fill="black" stroke="black" points="22454.73,-78 22464.73,-74.5 22454.73,-71 22454.73,-78"/>
</g>
<!-- norm_ffn_23 -->
<g id="node167" class="node">
<title>norm_ffn_23</title>
<polygon fill="#ffffff" stroke="black" points="22577,-56.5 22577,-92.5 22669,-92.5 22669,-56.5 22577,-56.5"/>
<text text-anchor="middle" x="22623" y="-70.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_attn_23&#45;&gt;norm_ffn_23 -->
<g id="edge188" class="edge">
<title>drop_attn_23&#45;&gt;norm_ffn_23</title>
<path fill="none" stroke="black" d="M22540.02,-74.5C22548.42,-74.5 22557.54,-74.5 22566.54,-74.5"/>
<polygon fill="black" stroke="black" points="22566.61,-78 22576.61,-74.5 22566.61,-71 22566.61,-78"/>
</g>
<!-- ffn_23 -->
<g id="node168" class="node">
<title>ffn_23</title>
<polygon fill="#ffffff" stroke="black" points="22706,-55.5 22706,-93.5 22851,-93.5 22851,-55.5 22706,-55.5"/>
<text text-anchor="middle" x="22778.5" y="-78.3" font-family="Times,serif" font-size="14.00">SwiGLU FFN</text>
<text text-anchor="middle" x="22778.5" y="-63.3" font-family="Times,serif" font-size="14.00">Hidden dim: 4096</text>
</g>
<!-- norm_ffn_23&#45;&gt;ffn_23 -->
<g id="edge189" class="edge">
<title>norm_ffn_23&#45;&gt;ffn_23</title>
<path fill="none" stroke="black" d="M22669.22,-74.5C22677.58,-74.5 22686.53,-74.5 22695.59,-74.5"/>
<polygon fill="black" stroke="black" points="22695.82,-78 22705.82,-74.5 22695.82,-71 22695.82,-78"/>
</g>
<!-- drop_ffn_23 -->
<g id="node169" class="node">
<title>drop_ffn_23</title>
<polygon fill="#ffffff" stroke="black" points="22888,-56.5 22888,-92.5 22963,-92.5 22963,-56.5 22888,-56.5"/>
<text text-anchor="middle" x="22925.5" y="-70.8" font-family="Times,serif" font-size="14.00">Dropout</text>
</g>
<!-- ffn_23&#45;&gt;drop_ffn_23 -->
<g id="edge190" class="edge">
<title>ffn_23&#45;&gt;drop_ffn_23</title>
<path fill="none" stroke="black" d="M22851.15,-74.5C22860.18,-74.5 22869.23,-74.5 22877.73,-74.5"/>
<polygon fill="black" stroke="black" points="22877.8,-78 22887.8,-74.5 22877.8,-71 22877.8,-78"/>
</g>
<!-- residual_out_23 -->
<g id="node170" class="node">
<title>residual_out_23</title>
<polygon fill="#f4f6f8" stroke="black" points="23000,-56.5 23000,-92.5 23129,-92.5 23129,-56.5 23000,-56.5"/>
<text text-anchor="middle" x="23064.5" y="-70.8" font-family="Times,serif" font-size="14.00">residual_out_23</text>
</g>
<!-- drop_ffn_23&#45;&gt;residual_out_23 -->
<!-- final_norm -->
<g id="node171" class="node">
<title>final_norm</title>
<polygon fill="#ffffff" stroke="black" points="23018.5,-1.5 23018.5,-37.5 23110.5,-37.5 23110.5,-1.5 23018.5,-1.5"/>
<text text-anchor="middle" x="23064.5" y="-15.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
</g>
<!-- drop_ffn_23&#45;&gt;final_norm -->
<g id="edge194" class="edge">
<title>drop_ffn_23&#45;&gt;final_norm</title>
<path fill="none" stroke="black" d="M22963.27,-76.1C22969.23,-75.9 22975.3,-75.42 22981,-74.5"/>
<path fill="none" stroke="black" d="M22982,-74.5C22996.61,-72.14 22988.69,-56.04 23000,-46.5 23003,-43.97 23006.28,-41.64 23009.71,-39.5"/>
<polygon fill="black" stroke="black" points="23011.47,-42.53 23018.49,-34.6 23008.05,-36.42 23011.47,-42.53"/>
</g>
<!-- lm_head -->
<g id="node172" class="node">
<title>lm_head</title>
<polygon fill="#f4f6f8" stroke="black" points="23166,-0.5 23166,-38.5 23405,-38.5 23405,-0.5 23166,-0.5"/>
<text text-anchor="middle" x="23285.5" y="-23.3" font-family="Times,serif" font-size="14.00">lm_head (Linear)</text>
<text text-anchor="middle" x="23285.5" y="-8.3" font-family="Times,serif" font-size="14.00">(d_model 1024 â†’ vocab 50257)</text>
</g>
<!-- final_norm&#45;&gt;lm_head -->
<g id="edge195" class="edge">
<title>final_norm&#45;&gt;lm_head</title>
<path fill="none" stroke="black" d="M23110.61,-19.5C23124.09,-19.5 23139.59,-19.5 23155.66,-19.5"/>
<polygon fill="black" stroke="black" points="23155.73,-23 23165.73,-19.5 23155.73,-16 23155.73,-23"/>
</g>
<!-- output -->
<g id="node173" class="node">
<title>output</title>
<polygon fill="#d8e6f3" stroke="black" points="23576,-37.5 23442,-37.5 23442,-1.5 23576,-1.5 23576,-37.5"/>
<text text-anchor="middle" x="23509" y="-15.8" font-family="Times,serif" font-size="14.00">Logits / Softmax</text>
</g>
<!-- lm_head&#45;&gt;output -->
<g id="edge196" class="edge">
<title>lm_head&#45;&gt;output</title>
<path fill="none" stroke="black" d="M23405.03,-19.5C23414.12,-19.5 23423.15,-19.5 23431.85,-19.5"/>
<polygon fill="black" stroke="black" points="23431.91,-23 23441.91,-19.5 23431.91,-16 23431.91,-23"/>
</g>
</g>
</svg>
