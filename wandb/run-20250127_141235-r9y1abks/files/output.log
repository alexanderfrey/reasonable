Using device: cuda
Found 1 files
Total tokens: 338026
/home/alexander/Projects/financial_projects/reasonable/train.py:227: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
Epoch 1:   0%|                                                                                                                                                                            | 0/37913 [00:00<?, ?it/s]/home/alexander/Projects/financial_projects/reasonable/train.py:38: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(device_type='cuda', dtype=torch.float16):
Epoch 1:   0%|                                                                                                                                                                            | 0/37913 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/alexander/Projects/financial_projects/reasonable/train.py", line 237, in <module>
    train_loss = train_one_epoch(model, train_loader, optimizer, scheduler, scaler, device, epoch)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexander/Projects/financial_projects/reasonable/train.py", line 38, in train_one_epoch
    with autocast(device_type='cuda', dtype=torch.float16):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexander/miniconda3/envs/pytorch/lib/python3.12/site-packages/typing_extensions.py", line 2853, in wrapper
    return arg(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
TypeError: autocast.__init__() got an unexpected keyword argument 'device_type'
