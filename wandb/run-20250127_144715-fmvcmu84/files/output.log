Found 1 files
Total tokens: 338026
/home/alexander/Projects/financial_projects/reasonable/train.py:443: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
Epoch 1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6318/6318 [12:45<00:00,  8.25it/s, loss=0.0958, avg_loss=1.5658, lr=3.00e-04]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 703/703 [00:22<00:00, 31.03it/s]
Epoch 1/50
Train Loss: 0.7827
Val Loss: 0.0246
Saved checkpoint to checkpoints/best_model.pt
Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6318/6318 [12:46<00:00,  8.24it/s, loss=0.0454, avg_loss=0.0613, lr=3.00e-04]
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 703/703 [00:22<00:00, 31.45it/s]
Epoch 2/50
Train Loss: 0.0307
Val Loss: 0.0132
Saved checkpoint to checkpoints/best_model.pt
Epoch 3:   1%|█                                                                                                                        | 58/6318 [00:07<13:00,  8.02it/s, loss=0.0434, avg_loss=0.0436, lr=3.00e-04]
Traceback (most recent call last):
  File "/home/alexander/Projects/financial_projects/reasonable/train.py", line 452, in <module>
    vocab_size = get_vocab_size("gpt2")
                     ^^^^^^^^^^^^^^^^^^
  File "/home/alexander/Projects/financial_projects/reasonable/train.py", line 219, in train_one_epoch
    is_accumulation_step = (batch_idx + 1) % gradient_accumulation_steps != 0
                  ^^^^^^^^^^^
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/alexander/Projects/financial_projects/reasonable/train.py", line 452, in <module>
[rank0]:     vocab_size = get_vocab_size("gpt2")
[rank0]:                      ^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alexander/Projects/financial_projects/reasonable/train.py", line 219, in train_one_epoch
[rank0]:     is_accumulation_step = (batch_idx + 1) % gradient_accumulation_steps != 0
[rank0]:                   ^^^^^^^^^^^
[rank0]: KeyboardInterrupt
